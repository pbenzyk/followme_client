(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{607:function(e,t,o){var content=o(680);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(27).default)("a01c101c",content,!0,{sourceMap:!1})},635:function(e,t,o){"use strict";o(53),o(39),o(70),o(52),o(28),o(19),o(71),o(85),o(54);var r=o(13),n=(o(7),o(21),o(404),o(37),o(778));function d(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return c(e,t)}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,d=!0,f=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return d=e.done,e},e:function(e){f=!0,n=e},f:function(){try{d||null==o.return||o.return()}finally{if(f)throw n}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}var f=.5;t.a={drawSkeleton:function(e,t,o){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;o.strokeStyle=t,o.lineWidth=3,n.b.getAdjacentPairs(n.a.MoveNet).forEach((function(t){var n=Object(r.a)(t,2),i=n[0],c=n[1],v=e[i],l=e[c],h=null!=v.score?v.score:1,y=null!=l.score?l.score:1;h>=f&&y>=f&&(o.beginPath(),o.moveTo(v.x*d,v.y*d),o.lineTo(l.x*d,l.y*d),o.stroke())}))},drawKeypoints:function(e,t,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,c=n.b.getKeypointIndexBySide(n.a.MoveNet);o.fillStyle=t;var f,v=d(c.middle);try{for(v.s();!(f=v.n()).done;){var i=f.value;this.drawKeypoint(e[i],o,r)}}catch(e){v.e(e)}finally{v.f()}var l,h=d(c.left);try{for(h.s();!(l=h.n()).done;){var y=l.value;this.drawKeypoint(e[y],o,r)}}catch(e){h.e(e)}finally{h.f()}var m,k=d(c.right);try{for(k.s();!(m=k.n()).done;){var O=m.value;this.drawKeypoint(e[O],o,r)}}catch(e){k.e(e)}finally{k.f()}},drawKeypoint:function(e,t,o){(null!=e.score?e.score:1)>=f&&(t.beginPath(),t.arc(e.x*o,e.y*o,5,0,2*Math.PI),t.fill())},toCOCO:function(e){return{keypoints:[e.keypoints[0],e.keypoints[2],e.keypoints[5],e.keypoints[7],e.keypoints[8],e.keypoints[11],e.keypoints[12],e.keypoints[13],e.keypoints[14],e.keypoints[15],e.keypoints[16],e.keypoints[23],e.keypoints[24],e.keypoints[25],e.keypoints[26],e.keypoints[27],e.keypoints[28]]}},getSupportedMimeTypes:function(){var e=["webm","ogg","mp4","x-matroska"],t=["vp9","vp9.0","vp8","vp8.0","avc1","av1","h265","h.265","h264","h.264","opus","pcm","aac","mpeg","mp4a"];for(var i in e){var o="".concat("video","/").concat(e[i]);for(var r in t){var n=["".concat(o,";codecs=").concat(t[r]),"".concat(o,";codecs:").concat(t[r]),"".concat(o,";codecs=").concat(t[r].toUpperCase()),"".concat(o,";codecs:").concat(t[r].toUpperCase())];for(var d in n)if(MediaRecorder.isTypeSupported(n[d]))return n[d]}if(MediaRecorder.isTypeSupported(o))return o}return!1}}},679:function(e,t,o){"use strict";o(607)},680:function(e,t,o){var r=o(26)(!1);r.push([e.i,".video-feedback{position:absolute;width:85%;overflow:hidden}.video-feedback.learner{left:20%}",""]),e.exports=r},705:function(e,t){},706:function(e,t){},749:function(e,t){},783:function(e,t,o){"use strict";o.r(t);var r=o(6),n=(o(58),{pose:{trainer:null,learner:null}}),d=(o(780),function(e,t,o,r,n,d,c){}),c=o(635),f=o(40),v={name:"VideoFeedback",props:{type:{type:String},videoOptions:{type:Object,default:function(){return{loadPose:!0,showSkeleton:!0,audio:0,opacity:1,mirror:!0,drawFeedbackBody:!0,drawFeedbackArms:!0,drawFeedbackLegs:!0,feedbackType:null}}}},data:function(){return{videoSrc:null,videoWidth:640,videoHeight:360,ratio:.5625,offscreenCanvas:null,poseVideoJson:null,timestamp:0,boneColor:"trainer"===this.type?"#ff147a":"#2babff",jointColor:"trainer"===this.type?"#ff87ba":"#D4E6F1"}},directives:{playbackRate:function(e,t){"number"==typeof t.value&&(e.playbackRate=t.value)},audioLevel:function(e,t){e.volume=t.value}},methods:{play:function(){this.$refs.videoObj.play()},pause:function(){this.$refs.videoObj.pause()},setSrc:function(e){this.videoSrc=e,this.$refs.videoObj.src=e,this.loadPose()},setSrcObject:function(e){var t=this;this.$refs.videoObj.srcObject=e,this.$refs.videoObj.onloadedmetadata=function(){t.$refs.videoObj.play()}},setCurrentTime:function(time){if(this.$refs.videoObj.currentTime=time,this.poseVideoJson)for(this.recordedVideoIndex=0;this.poseVideoJson.recorded[this.recordedVideoIndex]&&time>this.poseVideoJson.recorded[this.recordedVideoIndex].time;)this.recordedVideoIndex++},setEstimators:function(e){this.detector=e},loadPose:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f.a.get(e.videoSrc+".json");case 3:o=t.sent,e.poseVideoJson=o.data,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.warn("Error loading recorded pose.");case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},poseDetectionFrame:function(){var e=arguments,t=this;return Object(r.a)(regeneratorRuntime.mark((function o(){var r,c;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=e.length>0&&void 0!==e[0]&&e[0],t.$refs.videoObj&&t.$refs.videoOut&&(r||!t.$refs.videoObj.paused)){o.next=3;break}return o.abrupt("return");case 3:return o.prev=3,o.next=6,t.poseDetectionVideo();case 6:"learner"===t.type&&d(t.videoOptions.feedbackType,n.pose.trainer,n.pose.learner,t.videoOptions.drawFeedbackBody,t.videoOptions.drawFeedbackArms,t.videoOptions.drawFeedbackLegs,t.offscreenCanvas.getContext("2d")),(c=t.$refs.videoOut.getContext("2d")).clearRect(0,0,t.$refs.videoOut.width,t.$refs.videoOut.height),c.drawImage(t.offscreenCanvas,0,0,t.$refs.videoOut.width,t.$refs.videoOut.height),o.next=15;break;case 12:o.prev=12,o.t0=o.catch(3),console.error(o.t0);case 15:case"end":return o.stop()}}),o,null,[[3,12]])})))()},poseDetectionVideo:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var o,r,mask,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((o=e.offscreenCanvas.getContext("2d")).clearRect(0,0,e.videoWidth,e.videoHeight),o.save(),o.globalAlpha=e.videoOptions.opacity,e.videoOptions.mirror&&(o.scale(-1,1),o.translate(-e.videoWidth,0)),o.drawImage(e.$refs.videoObj,0,0,e.videoWidth,e.videoHeight),o.restore(),e.timestamp=e.$refs.videoObj.currentTime,r=null,mask=null,!(e.videoOptions.loadPose&&e.poseVideoJson&&e.poseVideoJson.recorded[e.recordedVideoIndex])){t.next=15;break}for(;e.poseVideoJson.recorded[e.recordedVideoIndex]&&e.timestamp>e.poseVideoJson.recorded[e.recordedVideoIndex].time;)e.recordedVideoIndex++;e.poseVideoJson.recorded[e.recordedVideoIndex]&&e.poseVideoJson.recorded[e.recordedVideoIndex].time-e.timestamp<.2&&(r=e.poseVideoJson.recorded[e.recordedVideoIndex].pose),t.next=20;break;case 15:return t.next=17,e.detector.estimatePoses(e.offscreenCanvas);case 17:(d=t.sent)[0]&&(r=c.a.toCOCO(d[0])),mask=d.segmentationMask;case 20:0===e.videoOptions.opacity?o.clearRect(0,0,e.videoWidth,e.videoHeight):"learner"===e.type&&mask&&(o.save(),o.globalCompositeOperation="destination-in",o.drawImage(mask,0,0,e.videoWidth,e.videoHeight),o.restore()),e.videoOptions.showSkeleton&&r&&(c.a.drawSkeleton(r.keypoints,e.boneColor,o),c.a.drawKeypoints(r.keypoints,e.jointColor,o)),n.pose[e.type]=r;case 23:case"end":return t.stop()}}),t)})))()},onVideoMetaLoaded:function(){this.videoWidth=this.$refs.videoObj.videoWidth,this.videoHeight=this.$refs.videoObj.videoHeight,this.ratio=this.videoHeight/this.videoWidth,this.offscreenCanvas.width=this.videoWidth,this.offscreenCanvas.height=this.videoHeight,this.$emit("loadedmetadata",this.$refs.videoObj.duration)},onResize:function(e){this.$refs.videoOut.width=e.width,this.$refs.videoOut.height=e.width*this.ratio,this.$nextTick((function(){this.detector&&this.poseDetectionFrame()}))},clear:function(){this.recordedVideoIndex=0,n.pose[this.type]=null}},mounted:function(){this.offscreenCanvas=document.createElement("canvas"),this.clear()},beforeUnmount:function(){this.clear(),this.$refs.videoObj.pause();var e=this.$refs.videoObj.srcObject;if(e)for(var t=e.getTracks(),i=0;i<t.length;i++){t[i].stop()}}},l=v,h=(o(679),o(66)),component=Object(h.a)(l,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"video-feedback",class:e.type},[o("video",{directives:[{name:"audio-level",rawName:"v-audio-level",value:e.videoOptions.audio,expression:"videoOptions.audio"},{name:"playback-rate",rawName:"v-playback-rate",value:!!e.videoSrc&&1,expression:"(videoSrc) ? 1 : false"}],ref:"videoObj",attrs:{playsinline:"",preload:"",width:e.videoWidth,height:e.videoHeight,crossorigin:"anonymous"},on:{loadedmetadata:e.onVideoMetaLoaded,timeupdate:function(t){e.$refs.videoObj&&e.$emit("timeupdate",e.$refs.videoObj.currentTime)},ended:function(t){return e.$emit("ended")}}}),e._v(" "),o("canvas",{ref:"videoOut"})])}),[],!1,null,null,null);t.default=component.exports}}]);