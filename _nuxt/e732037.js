/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{573:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BLAZEPOSE_CONNECTED_KEYPOINTS_PAIRS=t.COCO_CONNECTED_KEYPOINTS_PAIRS=t.COCO_KEYPOINTS_BY_SIDE=t.BLAZEPOSE_KEYPOINTS_BY_SIDE=t.BLAZEPOSE_KEYPOINTS=t.COCO_KEYPOINTS=void 0,t.COCO_KEYPOINTS=["nose","left_eye","right_eye","left_ear","right_ear","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle"],t.BLAZEPOSE_KEYPOINTS=["nose","left_eye_inner","left_eye","left_eye_outer","right_eye_inner","right_eye","right_eye_outer","left_ear","right_ear","mouth_left","mouth_right","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_pinky","right_pinky","left_index","right_index","left_thumb","right_thumb","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle","left_heel","right_heel","left_foot_index","right_foot_index"],t.BLAZEPOSE_KEYPOINTS_BY_SIDE={left:[1,2,3,7,9,11,13,15,17,19,21,23,25,27,29,31],right:[4,5,6,8,10,12,14,16,18,20,22,24,26,28,30,32],middle:[0]},t.COCO_KEYPOINTS_BY_SIDE={left:[1,3,5,7,9,11,13,15],right:[2,4,6,8,10,12,14,16],middle:[0]},t.COCO_CONNECTED_KEYPOINTS_PAIRS=[[0,1],[0,2],[1,3],[2,4],[5,6],[5,7],[5,11],[6,8],[6,12],[7,9],[8,10],[11,12],[11,13],[12,14],[13,15],[14,16]],t.BLAZEPOSE_CONNECTED_KEYPOINTS_PAIRS=[[0,1],[0,4],[1,2],[2,3],[3,7],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[11,23],[12,14],[14,16],[12,24],[13,15],[15,17],[16,18],[16,20],[15,17],[15,19],[15,21],[16,22],[17,19],[18,20],[23,25],[23,24],[24,26],[25,27],[26,28],[27,29],[28,30],[27,31],[28,32],[29,31],[30,32]]},581:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProjectiveTransformMatrix=t.getRoi=t.padRoi=t.toImageTensor=t.transformValueRange=t.normalizeRadians=t.getImageSize=void 0;var r=n(545);function o(e,t){r.util.assert(0!==e.width,(function(){return t+" width cannot be 0."})),r.util.assert(0!==e.height,(function(){return t+" height cannot be 0."}))}t.getImageSize=function(input){return input instanceof r.Tensor?{height:input.shape[0],width:input.shape[1]}:{height:input.height,width:input.width}},t.normalizeRadians=function(e){return e-2*Math.PI*Math.floor((e+Math.PI)/(2*Math.PI))},t.transformValueRange=function(e,t,n,r){var o=t-e,l=r-n;if(0===o)throw new Error("Original min and max are both "+e+", range cannot be 0.");var c=l/o;return{scale:c,offset:n-e*c}},t.toImageTensor=function(input){return input instanceof r.Tensor?input:r.browser.fromPixels(input)},t.padRoi=function(e,t,n){if(void 0===n&&(n=!1),!n)return{top:0,left:0,right:0,bottom:0};var r=t.height,l=t.width;o(t,"targetSize"),o(e,"roi");var c,h,f=r/l,d=e.height/e.width,_=0,y=0;return f>d?(c=e.width,h=e.width*f,y=(1-d/f)/2):(c=e.height/f,h=e.height,_=(1-f/d)/2),e.width=c,e.height=h,{top:y,left:_,right:_,bottom:y}},t.getRoi=function(e,t){return t?{xCenter:t.xCenter*e.width,yCenter:t.yCenter*e.height,width:t.width*e.width,height:t.height*e.height,rotation:t.rotation}:{xCenter:.5*e.width,yCenter:.5*e.height,width:e.width,height:e.height,rotation:0}},t.getProjectiveTransformMatrix=function(e,t,n){return o(n,"inputResolution"),[1/n.width*e[0][0]*t.width,1/n.height*e[0][1]*t.width,e[0][3]*t.width,1/n.width*e[1][0]*t.height,1/n.height*e[1][1]*t.height,e[1][3]*t.height,0,0]}},630:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MILLISECOND_TO_MICRO_SECONDS=t.SECOND_TO_MICRO_SECONDS=t.MICRO_SECONDS_TO_SECOND=void 0,t.MICRO_SECONDS_TO_SECOND=1e-6,t.SECOND_TO_MICRO_SECONDS=1e6,t.MILLISECOND_TO_MICRO_SECONDS=1e3},631:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LowPassFilter=void 0;var r=function(){function e(e){this.alpha=e,this.initialized=!1}return e.prototype.apply=function(e,t){var n;return this.initialized?n=null==t?this.storedValue+this.alpha*(e-this.storedValue):this.storedValue+this.alpha*t*Math.asinh((e-this.storedValue)/t):(n=e,this.initialized=!0),this.rawValue=e,this.storedValue=n,n},e.prototype.applyWithAlpha=function(e,t,n){return this.alpha=t,this.apply(e,n)},e.prototype.hasLastRawValue=function(){return this.initialized},e.prototype.lastRawValue=function(){return this.rawValue},e.prototype.reset=function(){this.initialized=!1},e}();t.LowPassFilter=r},632:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SupportedModels=void 0,function(e){e.MoveNet="MoveNet",e.BlazePose="BlazePose",e.PoseNet="PoseNet"}(t.SupportedModels||(t.SupportedModels={}))},633:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_BOUNDING_BOX_TRACKER_CONFIG=t.DEFAULT_KEYPOINT_TRACKER_CONFIG=t.MULTIPOSE_INSTANCE_SIZE=t.MULTIPOSE_BOX_SCORE_IDX=t.MULTIPOSE_BOX_IDX=t.MULTIPOSE_BOX_SIZE=t.NUM_KEYPOINT_VALUES=t.NUM_KEYPOINTS=t.DEFAULT_MIN_POSE_SCORE=t.MIN_CROP_KEYPOINT_SCORE=t.CROP_FILTER_ALPHA=t.KEYPOINT_FILTER_CONFIG=t.MOVENET_ESTIMATION_CONFIG=t.MOVENET_CONFIG=t.MOVENET_MULTIPOSE_DEFAULT_MAX_DIMENSION=t.MOVENET_SINGLEPOSE_THUNDER_RESOLUTION=t.MOVENET_SINGLEPOSE_LIGHTNING_RESOLUTION=t.MOVENET_MULTIPOSE_LIGHTNING_URL=t.MOVENET_SINGLEPOSE_THUNDER_URL=t.MOVENET_SINGLEPOSE_LIGHTNING_URL=t.VALID_MODELS=t.MULTIPOSE_LIGHTNING=t.SINGLEPOSE_THUNDER=t.SINGLEPOSE_LIGHTNING=void 0,t.SINGLEPOSE_LIGHTNING="SinglePose.Lightning",t.SINGLEPOSE_THUNDER="SinglePose.Thunder",t.MULTIPOSE_LIGHTNING="MultiPose.Lightning",t.VALID_MODELS=[t.SINGLEPOSE_LIGHTNING,t.SINGLEPOSE_THUNDER,t.MULTIPOSE_LIGHTNING],t.MOVENET_SINGLEPOSE_LIGHTNING_URL="https://tfhub.dev/google/tfjs-model/movenet/singlepose/lightning/4",t.MOVENET_SINGLEPOSE_THUNDER_URL="https://tfhub.dev/google/tfjs-model/movenet/singlepose/thunder/4",t.MOVENET_MULTIPOSE_LIGHTNING_URL="https://tfhub.dev/google/tfjs-model/movenet/multipose/lightning/1",t.MOVENET_SINGLEPOSE_LIGHTNING_RESOLUTION=192,t.MOVENET_SINGLEPOSE_THUNDER_RESOLUTION=256,t.MOVENET_MULTIPOSE_DEFAULT_MAX_DIMENSION=256,t.MOVENET_CONFIG={modelType:t.SINGLEPOSE_LIGHTNING,enableSmoothing:!0},t.MOVENET_ESTIMATION_CONFIG={},t.KEYPOINT_FILTER_CONFIG={frequency:30,minCutOff:2.5,beta:300,derivateCutOff:2.5,thresholdCutOff:.5,thresholdBeta:5,disableValueScaling:!0},t.CROP_FILTER_ALPHA=.9,t.MIN_CROP_KEYPOINT_SCORE=.2,t.DEFAULT_MIN_POSE_SCORE=.25,t.NUM_KEYPOINTS=17,t.NUM_KEYPOINT_VALUES=3,t.MULTIPOSE_BOX_SIZE=5,t.MULTIPOSE_BOX_IDX=t.NUM_KEYPOINTS*t.NUM_KEYPOINT_VALUES,t.MULTIPOSE_BOX_SCORE_IDX=t.MULTIPOSE_BOX_IDX+4,t.MULTIPOSE_INSTANCE_SIZE=t.NUM_KEYPOINTS*t.NUM_KEYPOINT_VALUES+t.MULTIPOSE_BOX_SIZE,t.DEFAULT_KEYPOINT_TRACKER_CONFIG={maxTracks:18,maxAge:1e3,minSimilarity:.2,keypointTrackerParams:{keypointConfidenceThreshold:.3,keypointFalloff:[.026,.025,.025,.035,.035,.079,.079,.072,.072,.062,.062,.107,.107,.087,.087,.089,.089],minNumberOfKeypoints:4}},t.DEFAULT_BOUNDING_BOX_TRACKER_CONFIG={maxTracks:18,maxAge:1e3,minSimilarity:.15,trackerParams:{}}},634:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.POSE_CHAIN=t.NUM_KEYPOINTS=t.K_LOCAL_MAXIMUM_RADIUS=t.RESNET_MEAN=t.MULTI_PERSON_ESTIMATION_CONFIG=t.SINGLE_PERSON_ESTIMATION_CONFIG=t.VALID_QUANT_BYTES=t.VALID_MULTIPLIER=t.VALID_OUTPUT_STRIDES=t.VALID_STRIDE=t.VALID_ARCHITECTURE=t.MOBILENET_V1_CONFIG=void 0,t.MOBILENET_V1_CONFIG={architecture:"MobileNetV1",outputStride:16,multiplier:.75,inputResolution:{height:257,width:257}},t.VALID_ARCHITECTURE=["MobileNetV1","ResNet50"],t.VALID_STRIDE={MobileNetV1:[8,16],ResNet50:[16]},t.VALID_OUTPUT_STRIDES=[8,16,32],t.VALID_MULTIPLIER={MobileNetV1:[.5,.75,1],ResNet50:[1]},t.VALID_QUANT_BYTES=[1,2,4],t.SINGLE_PERSON_ESTIMATION_CONFIG={maxPoses:1,flipHorizontal:!1},t.MULTI_PERSON_ESTIMATION_CONFIG={maxPoses:5,flipHorizontal:!1,scoreThreshold:.5,nmsRadius:20},t.RESNET_MEAN=[-123.15,-115.9,-103.06],t.K_LOCAL_MAXIMUM_RADIUS=1,t.NUM_KEYPOINTS=17,t.POSE_CHAIN=[["nose","left_eye"],["left_eye","left_ear"],["nose","right_eye"],["right_eye","right_ear"],["nose","left_shoulder"],["left_shoulder","left_elbow"],["left_elbow","left_wrist"],["left_shoulder","left_hip"],["left_hip","left_knee"],["left_knee","left_ankle"],["nose","right_shoulder"],["right_shoulder","right_elbow"],["right_elbow","right_wrist"],["right_shoulder","right_hip"],["right_hip","right_knee"],["right_knee","right_ankle"]]},678:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackerType=void 0,function(e){e.Keypoint="keypoint",e.BoundingBox="boundingBox"}(t.TrackerType||(t.TrackerType={}))},766:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{f(r.next(e))}catch(e){l(e)}}function h(e){try{f(r.throw(e))}catch(e){l(e)}}function f(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,h)}f((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.assertMaskValue=t.toTensorLossy=t.toImageDataLossy=t.toHTMLCanvasElementLossy=void 0;var l=n(545);function c(e){return e instanceof SVGAnimatedLength?e.baseVal.value:e}function h(image){return r(this,void 0,void 0,(function(){var canvas,e;return o(this,(function(t){switch(t.label){case 0:return canvas=document.createElement("canvas"),image instanceof l.Tensor?[4,l.browser.toPixels(image,canvas)]:[3,2];case 1:return t.sent(),[3,3];case 2:canvas.width=c(image.width),canvas.height=c(image.height),e=canvas.getContext("2d"),image instanceof ImageData?e.putImageData(image,0,0):e.drawImage(image,0,0),t.label=3;case 3:return[2,canvas]}}))}))}t.toHTMLCanvasElementLossy=h,t.toImageDataLossy=function(image){return r(this,void 0,void 0,(function(){var e,t,n,r,canvas,h;return o(this,(function(o){switch(o.label){case 0:return image instanceof l.Tensor?(e=image.shape.slice(0,2),t=e[0],n=e[1],r=ImageData.bind,[4,l.browser.toPixels(image)]):[3,2];case 1:return[2,new(r.apply(ImageData,[void 0,o.sent(),n,t]))];case 2:return canvas=document.createElement("canvas"),h=canvas.getContext("2d"),canvas.width=c(image.width),canvas.height=c(image.height),h.drawImage(image,0,0),[2,h.getImageData(0,0,canvas.width,canvas.height)]}}))}))},t.toTensorLossy=function(image){return r(this,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:return image instanceof SVGImageElement||image instanceof OffscreenCanvas?[4,h(image)]:[3,2];case 1:return t=n.sent(),[3,3];case 2:t=image,n.label=3;case 3:return e=t,[2,l.browser.fromPixels(e,4)]}}))}))},t.assertMaskValue=function(e){if(e<0||e>=256)throw new Error("Mask value must be in range [0, 255] but got "+e);if(!Number.isInteger(e))throw new Error("Mask value must be an integer but got "+e)}},768:function(e,t,n){"use strict";function r(e){if(16!==e.length)throw new Error("Array length must be 16 but got "+e.length);return[[e[0],e[1],e[2],e[3]],[e[4],e[5],e[6],e[7]],[e[8],e[9],e[10],e[11]],[e[12],e[13],e[14],e[15]]]}function o(e,t,n,r,o,l,c){return e[t][o]*(e[n][l]*e[r][c]-e[n][c]*e[r][l])}function l(e,i,t){var n=(i+1)%4,r=(i+2)%4,l=(i+3)%4,c=(t+1)%4,h=(t+2)%4,f=(t+3)%4;return o(e,n,r,l,c,h,f)+o(e,r,l,n,c,h,f)+o(e,l,n,r,c,h,f)}Object.defineProperty(t,"__esModule",{value:!0}),t.calculateInverseMatrix=t.arrayToMatrix4x4=t.matrix4x4ToArray=void 0,t.matrix4x4ToArray=function(e){return[].concat.apply([],e)},t.arrayToMatrix4x4=r,t.calculateInverseMatrix=function(e){var t=r(new Array(16).fill(0));t[0][0]=l(e,0,0),t[1][0]=-l(e,0,1),t[2][0]=l(e,0,2),t[3][0]=-l(e,0,3),t[0][2]=l(e,2,0),t[1][2]=-l(e,2,1),t[2][2]=l(e,2,2),t[3][2]=-l(e,2,3),t[0][1]=-l(e,1,0),t[1][1]=l(e,1,1),t[2][1]=-l(e,1,2),t[3][1]=l(e,1,3),t[0][3]=-l(e,3,0),t[1][3]=l(e,3,1),t[2][3]=-l(e,3,2),t[3][3]=l(e,3,3);for(var n=e[0][0]*t[0][0]+e[1][0]*t[0][1]+e[2][0]*t[0][2]+e[3][0]*t[0][3],i=0;i<t.length;i++)for(var o=0;o<t.length;o++)t[i][o]/=n;return t}},769:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertImageToTensor=void 0;var r=n(545),o=n(870),l=n(581),c=n(770);t.convertImageToTensor=function(image,e,t){var n=e.outputTensorSize,h=e.keepAspectRatio,f=e.borderMode,d=e.outputTensorFloatRange,_=l.getImageSize(image),y=l.getRoi(_,t),m=l.padRoi(y,n,h),O=o.getRotatedSubRectToRectTransformMatrix(y,_.width,_.height,!1);return{imageTensor:r.tidy((function(){var e=l.toImageTensor(image),t=r.tensor2d(l.getProjectiveTransformMatrix(O,_,n),[1,8]),o="zero"===f?"constant":"nearest",h=r.image.transform(r.expandDims(r.cast(e,"float32")),t,"bilinear",o,0,[n.height,n.width]);return null!=d?c.shiftImageValue(h,d):h})),padding:m,transformationMatrix:O}}},770:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shiftImageValue=void 0;var r=n(545),o=n(581);t.shiftImageValue=function(image,e){var t=o.transformValueRange(0,255,e[0],e[1]);return r.tidy((function(){return r.add(r.mul(image,t.scale),t.offset)}))}},771:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVideo=void 0,t.isVideo=function(image){return null!=image&&null!=image.currentTime}},772:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.normalizedKeypointsToKeypoints=void 0,t.normalizedKeypointsToKeypoints=function(e,t){return e.map((function(e){var n=r(r({},e),{x:e.x*t.width,y:e.y*t.height});return null!=e.z&&(n.z=e.z*t.width),n}))}},773:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.keypointsToNormalizedKeypoints=void 0,t.keypointsToNormalizedKeypoints=function(e,t){return e.map((function(e){var n=r(r({},e),{x:e.x/t.width,y:e.y/t.height});return null!=e.z&&(e.z=e.z/t.width),n}))}},774:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},r.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var s=0,i=0,e=arguments.length;i<e;i++)s+=arguments[i].length;var t=Array(s),n=0;for(i=0;i<e;i++)for(var a=arguments[i],r=0,o=a.length;r<o;r++,n++)t[n]=a[r];return t};Object.defineProperty(t,"__esModule",{value:!0}),t.KeypointsOneEuroFilter=void 0;var l=n(887),c=function(){function e(e){this.config=e}return e.prototype.apply=function(e,t,n){var l=this;if(null==e)return this.reset(),null;this.initializeFiltersIfEmpty(e);var c=1;if(!this.config.disableValueScaling){if(n<this.config.minAllowedObjectScale)return o(e);c=1/n}return e.map((function(e,i){var n=r(r({},e),{x:l.xFilters[i].apply(e.x,t,c),y:l.yFilters[i].apply(e.y,t,c)});return null!=e.z&&(n.z=l.zFilters[i].apply(e.z,t,c)),n}))},e.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},e.prototype.initializeFiltersIfEmpty=function(e){var t=this;null!=this.xFilters&&this.xFilters.length===e.length||(this.xFilters=e.map((function(e){return new l.OneEuroFilter(t.config)})),this.yFilters=e.map((function(e){return new l.OneEuroFilter(t.config)})),this.zFilters=e.map((function(e){return new l.OneEuroFilter(t.config)})))},e}();t.KeypointsOneEuroFilter=c},775:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BLAZEPOSE_SEGMENTATION_SMOOTHING_CONFIG=t.BLAZEPOSE_TENSORS_TO_SEGMENTATION_CONFIG=t.BLAZEPOSE_WORLD_LANDMARKS_SMOOTHING_CONFIG_ACTUAL=t.BLAZEPOSE_LANDMARKS_SMOOTHING_CONFIG_AUXILIARY=t.BLAZEPOSE_LANDMARKS_SMOOTHING_CONFIG_ACTUAL=t.BLAZEPOSE_VISIBILITY_SMOOTHING_CONFIG=t.BLAZEPOSE_NUM_AUXILIARY_KEYPOINTS=t.BLAZEPOSE_NUM_KEYPOINTS=t.BLAZEPOSE_REFINE_LANDMARKS_FROM_HEATMAP_CONFIG=t.BLAZEPOSE_TENSORS_TO_WORLD_LANDMARKS_CONFIG=t.BLAZEPOSE_TENSORS_TO_LANDMARKS_CONFIG=t.BLAZEPOSE_POSE_PRESENCE_SCORE=t.BLAZEPOSE_LANDMARK_IMAGE_TO_TENSOR_CONFIG=t.BLAZEPOSE_DETECTOR_IMAGE_TO_TENSOR_CONFIG=t.BLAZEPOSE_DETECTOR_RECT_TRANSFORMATION_CONFIG=t.BLAZEPOSE_DETECTOR_NON_MAX_SUPPRESSION_CONFIGURATION=t.BLAZEPOSE_TENSORS_TO_DETECTION_CONFIGURATION=t.DEFAULT_BLAZEPOSE_ESTIMATION_CONFIG=t.DEFAULT_BLAZEPOSE_MODEL_CONFIG=t.BLAZEPOSE_DETECTOR_ANCHOR_CONFIGURATION=t.DEFAULT_BLAZEPOSE_LANDMARK_MODEL_URL_HEAVY=t.DEFAULT_BLAZEPOSE_LANDMARK_MODEL_URL_LITE=t.DEFAULT_BLAZEPOSE_LANDMARK_MODEL_URL_FULL=t.DEFAULT_BLAZEPOSE_DETECTOR_MODEL_URL=void 0,t.DEFAULT_BLAZEPOSE_DETECTOR_MODEL_URL="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/detector/1",t.DEFAULT_BLAZEPOSE_LANDMARK_MODEL_URL_FULL="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2",t.DEFAULT_BLAZEPOSE_LANDMARK_MODEL_URL_LITE="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/lite/2",t.DEFAULT_BLAZEPOSE_LANDMARK_MODEL_URL_HEAVY="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/heavy/2",t.BLAZEPOSE_DETECTOR_ANCHOR_CONFIGURATION={reduceBoxesInLowestlayer:!1,interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:5,minScale:.1484375,maxScale:.75,inputSizeHeight:224,inputSizeWidth:224,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,32,32,32],aspectRatios:[1],fixedAnchorSize:!0},t.DEFAULT_BLAZEPOSE_MODEL_CONFIG={runtime:"tfjs",modelType:"full",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,detectorModelUrl:t.DEFAULT_BLAZEPOSE_DETECTOR_MODEL_URL,landmarkModelUrl:t.DEFAULT_BLAZEPOSE_LANDMARK_MODEL_URL_FULL},t.DEFAULT_BLAZEPOSE_ESTIMATION_CONFIG={maxPoses:1,flipHorizontal:!1},t.BLAZEPOSE_TENSORS_TO_DETECTION_CONFIGURATION={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:2254,numCoords:12,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:4,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:224,yScale:224,hScale:224,wScale:224,minScoreThresh:.5},t.BLAZEPOSE_DETECTOR_NON_MAX_SUPPRESSION_CONFIGURATION={minSuppressionThreshold:.3,overlapType:"intersection-over-union"},t.BLAZEPOSE_DETECTOR_RECT_TRANSFORMATION_CONFIG={shiftX:0,shiftY:0,scaleX:1.25,scaleY:1.25,squareLong:!0},t.BLAZEPOSE_DETECTOR_IMAGE_TO_TENSOR_CONFIG={outputTensorSize:{width:224,height:224},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},t.BLAZEPOSE_LANDMARK_IMAGE_TO_TENSOR_CONFIG={outputTensorSize:{width:256,height:256},keepAspectRatio:!0,outputTensorFloatRange:[0,1],borderMode:"zero"},t.BLAZEPOSE_POSE_PRESENCE_SCORE=.5,t.BLAZEPOSE_TENSORS_TO_LANDMARKS_CONFIG={numLandmarks:39,inputImageWidth:256,inputImageHeight:256,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},t.BLAZEPOSE_TENSORS_TO_WORLD_LANDMARKS_CONFIG={numLandmarks:39,inputImageWidth:1,inputImageHeight:1,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},t.BLAZEPOSE_REFINE_LANDMARKS_FROM_HEATMAP_CONFIG={kernelSize:7,minConfidenceToRefine:.5},t.BLAZEPOSE_NUM_KEYPOINTS=33,t.BLAZEPOSE_NUM_AUXILIARY_KEYPOINTS=35,t.BLAZEPOSE_VISIBILITY_SMOOTHING_CONFIG={alpha:.1},t.BLAZEPOSE_LANDMARKS_SMOOTHING_CONFIG_ACTUAL={oneEuroFilter:{frequency:30,minCutOff:.05,beta:80,derivateCutOff:1,minAllowedObjectScale:1e-6}},t.BLAZEPOSE_LANDMARKS_SMOOTHING_CONFIG_AUXILIARY={oneEuroFilter:{frequency:30,minCutOff:.01,beta:10,derivateCutOff:1,minAllowedObjectScale:1e-6}},t.BLAZEPOSE_WORLD_LANDMARKS_SMOOTHING_CONFIG_ACTUAL={oneEuroFilter:{frequency:30,minCutOff:.1,beta:40,derivateCutOff:1,minAllowedObjectScale:1e-6,disableValueScaling:!0}},t.BLAZEPOSE_TENSORS_TO_SEGMENTATION_CONFIG={activation:"none"},t.BLAZEPOSE_SEGMENTATION_SMOOTHING_CONFIG={combineWithPreviousRatio:.7}},776:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},r.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var s=0,i=0,e=arguments.length;i<e;i++)s+=arguments[i].length;var t=Array(s),n=0;for(i=0;i<e;i++)for(var a=arguments[i],r=0,o=a.length;r<o;r++,n++)t[n]=a[r];return t};Object.defineProperty(t,"__esModule",{value:!0}),t.Tracker=void 0;var l=n(894),c=function(){function e(e){l.validateTrackerConfig(e),this.tracks=[],this.maxTracks=e.maxTracks,this.maxAge=1e3*e.maxAge,this.minSimilarity=e.minSimilarity,this.nextID=1}return e.prototype.apply=function(e,t){this.filterOldTracks(t);var n=this.computeSimilarity(e);return this.assignTracks(e,n,t),this.updateTracks(t),e},e.prototype.getTracks=function(){return this.tracks.slice()},e.prototype.getTrackIDs=function(){return new Set(this.tracks.map((function(track){return track.id})))},e.prototype.filterOldTracks=function(e){var t=this;this.tracks=this.tracks.filter((function(track){return e-track.lastTimestamp<=t.maxAge}))},e.prototype.assignTracks=function(e,t,n){for(var r=Array.from(Array(t[0].length).keys()),o=[],l=0,c=Array.from(Array(e.length).keys());l<c.length;l++){var h=c[l];if(0!==r.length){for(var f=-1,d=-1,_=0,y=r;_<y.length;_++){var m=y[_],O=t[h][m];O>=this.minSimilarity&&O>d&&(f=m,d=O)}if(f>=0){var E=this.tracks[f];E=Object.assign(E,this.createTrack(e[h],n,E.id)),e[h].id=E.id;var v=r.indexOf(f);r.splice(v,1)}else o.push(h)}else o.push(h)}for(var S=0,T=o;S<T.length;S++){h=T[S];var I=this.createTrack(e[h],n);this.tracks.push(I),e[h].id=I.id}},e.prototype.updateTracks=function(e){this.tracks.sort((function(e,t){return t.lastTimestamp-e.lastTimestamp})),this.tracks=this.tracks.slice(0,this.maxTracks)},e.prototype.createTrack=function(e,t,n){var track={id:n||this.nextTrackID(),lastTimestamp:t,keypoints:o(e.keypoints).map((function(e){return r({},e)}))};return void 0!==e.box&&(track.box=r({},e.box)),track},e.prototype.nextTrackID=function(){var e=this.nextID;return this.nextID+=1,e},e.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.tracks=this.tracks.filter((function(track){return!e.includes(track.id)}))},e.prototype.reset=function(){this.tracks=[]},e}();t.Tracker=c},777:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getKeypointIndexByName=t.getAdjacentPairs=t.getKeypointIndexBySide=void 0;var r=n(573),o=n(632);t.getKeypointIndexBySide=function(e){switch(e){case o.SupportedModels.BlazePose:return r.BLAZEPOSE_KEYPOINTS_BY_SIDE;case o.SupportedModels.PoseNet:case o.SupportedModels.MoveNet:return r.COCO_KEYPOINTS_BY_SIDE;default:throw new Error("Model "+e+" is not supported.")}},t.getAdjacentPairs=function(e){switch(e){case o.SupportedModels.BlazePose:return r.BLAZEPOSE_CONNECTED_KEYPOINTS_PAIRS;case o.SupportedModels.PoseNet:case o.SupportedModels.MoveNet:return r.COCO_CONNECTED_KEYPOINTS_PAIRS;default:throw new Error("Model "+e+" is not supported.")}},t.getKeypointIndexByName=function(e){switch(e){case o.SupportedModels.BlazePose:return r.BLAZEPOSE_KEYPOINTS.reduce((function(map,e,i){return map[e]=i,map}),{});case o.SupportedModels.PoseNet:case o.SupportedModels.MoveNet:return r.COCO_KEYPOINTS.reduce((function(map,e,i){return map[e]=i,map}),{});default:throw new Error("Model "+e+" is not supported.")}}},826:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var p in e)"default"===p||t.hasOwnProperty(p)||r(t,e,p)};Object.defineProperty(t,"__esModule",{value:!0}),t.movenet=t.calculators=t.util=void 0;var l=n(827);Object.defineProperty(t,"createDetector",{enumerable:!0,get:function(){return l.createDetector}}),o(n(632),t);var c=n(678);Object.defineProperty(t,"TrackerType",{enumerable:!0,get:function(){return c.TrackerType}});var h=n(777);t.util=h;var f={keypointsToNormalizedKeypoints:n(773).keypointsToNormalizedKeypoints};t.calculators=f;var d=n(633),_={modelType:{SINGLEPOSE_LIGHTNING:d.SINGLEPOSE_LIGHTNING,SINGLEPOSE_THUNDER:d.SINGLEPOSE_THUNDER,MULTIPOSE_LIGHTNING:d.MULTIPOSE_LIGHTNING}};t.movenet=_},827:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{f(r.next(e))}catch(e){l(e)}}function h(e){try{f(r.throw(e))}catch(e){l(e)}}function f(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,h)}f((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.createDetector=void 0;var l=n(828),c=n(844),h=n(892),f=n(898),d=n(632);t.createDetector=function(e,t){return r(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(e){case d.SupportedModels.PoseNet:return[2,f.load(t)];case d.SupportedModels.BlazePose:if(r=void 0,null!=(n=t)){if("tfjs"===n.runtime)return[2,c.load(t)];if("mediapipe"===n.runtime)return[2,l.load(t)];r=n.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got "+r);case d.SupportedModels.MoveNet:return[2,h.load(t)];default:throw new Error(e+" is not a supported model name.")}return[2]}))}))}},828:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{f(r.next(e))}catch(e){l(e)}}function h(e){try{f(r.throw(e))}catch(e){l(e)}}function f(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,h)}f((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.load=void 0;var l=n(702),c=n(545),h=n(573),f=n(766),d=n(842),_=function(){function e(mask){this.mask=mask}return e.prototype.toCanvasImageSource=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){return[2,this.mask]}))}))},e.prototype.toImageData=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){return[2,f.toImageDataLossy(this.mask)]}))}))},e.prototype.toTensor=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){return[2,f.toTensorLossy(this.mask)]}))}))},e.prototype.getUnderlyingType=function(){return"canvasimagesource"},e}();function y(e){return f.assertMaskValue(e),"person"}var m=function(){function e(e){var t,n=this;switch(this.width=0,this.height=0,this.selfieMode=!1,this.poseSolution=new l.Pose({locateFile:function(path,base){return e.solutionPath?e.solutionPath.replace(/\/+$/,"")+"/"+path:base+"/"+path}}),e.modelType){case"lite":t=0;break;case"heavy":t=2;break;default:t=1}this.poseSolution.setOptions({modelComplexity:t,smoothLandmarks:e.enableSmoothing,enableSegmentation:e.enableSegmentation,smoothSegmentation:e.smoothSegmentation,selfieMode:this.selfieMode}),this.poseSolution.onResults((function(e){if(n.height=e.image.height,n.width=e.image.width,null==e.poseLandmarks)n.poses=[];else{var t=n.translateOutput(e.poseLandmarks,e.poseWorldLandmarks);e.segmentationMask&&(t.segmentation={maskValueToLabel:y,mask:new _(e.segmentationMask)}),n.poses=[t]}}))}return e.prototype.translateOutput=function(e,t){var n=this,output={keypoints:e.map((function(e,i){return{x:e.x*n.width,y:e.y*n.height,z:e.z,score:e.visibility,name:h.BLAZEPOSE_KEYPOINTS[i]}}))};return null!=t&&(output.keypoints3D=t.map((function(e,i){return{x:e.x,y:e.y,z:e.z,score:e.visibility,name:h.BLAZEPOSE_KEYPOINTS[i]}}))),output},e.prototype.estimatePoses=function(image,e,t){return r(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return e&&e.flipHorizontal&&e.flipHorizontal!==this.selfieMode&&(this.selfieMode=e.flipHorizontal,this.poseSolution.setOptions({selfieMode:this.selfieMode})),image instanceof c.Tensor?(r=ImageData.bind,[4,c.browser.toPixels(image)]):[3,2];case 1:return n=new(r.apply(ImageData,[void 0,o.sent(),image.shape[1],image.shape[0]])),[3,3];case 2:n=image,o.label=3;case 3:return image=n,[4,this.poseSolution.send({image:image},t)];case 4:return o.sent(),[2,this.poses]}}))}))},e.prototype.dispose=function(){this.poseSolution.close()},e.prototype.reset=function(){this.poseSolution.reset()},e.prototype.initialize=function(){return this.poseSolution.initialize()},e}();t.load=function(e){return r(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return t=d.validateModelConfig(e),[4,(n=new m(t)).initialize()];case 1:return r.sent(),[2,n]}}))}))}},842:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.validateEstimationConfig=t.validateModelConfig=void 0;var o=n(843);t.validateModelConfig=function(e){if(null==e)return r({},o.DEFAULT_BLAZEPOSE_MODEL_CONFIG);var t=r({},e);return t.runtime="mediapipe",null==t.enableSegmentation&&(t.enableSegmentation=o.DEFAULT_BLAZEPOSE_MODEL_CONFIG.enableSegmentation),null==t.enableSmoothing&&(t.enableSmoothing=o.DEFAULT_BLAZEPOSE_MODEL_CONFIG.enableSmoothing),null==t.smoothSegmentation&&(t.smoothSegmentation=o.DEFAULT_BLAZEPOSE_MODEL_CONFIG.smoothSegmentation),null==t.modelType&&(t.modelType=o.DEFAULT_BLAZEPOSE_MODEL_CONFIG.modelType),t},t.validateEstimationConfig=function(e){if(null==e)return r({},o.DEFAULT_BLAZEPOSE_ESTIMATION_CONFIG);var t=r({},e);if(null==t.maxPoses&&(t.maxPoses=1),t.maxPoses<=0)throw new Error("Invalid maxPoses "+t.maxPoses+". Should be > 0.");if(t.maxPoses>1)throw new Error("Multi-pose detection is not implemented yet. Please set maxPoses to 1.");return null==t.flipHorizontal&&(t.flipHorizontal=o.DEFAULT_BLAZEPOSE_ESTIMATION_CONFIG.flipHorizontal),t}},843:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_BLAZEPOSE_ESTIMATION_CONFIG=t.DEFAULT_BLAZEPOSE_MODEL_CONFIG=void 0,t.DEFAULT_BLAZEPOSE_MODEL_CONFIG={runtime:"mediapipe",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,modelType:"full"},t.DEFAULT_BLAZEPOSE_ESTIMATION_CONFIG={maxPoses:1,flipHorizontal:!1}},844:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{f(r.next(e))}catch(e){l(e)}}function h(e){try{f(r.throw(e))}catch(e){l(e)}}function f(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,h)}f((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.load=void 0;var c=n(637),h=n(545),f=n(573),d=n(865),_=n(768),y=n(867),m=n(868),O=n(869),E=n(630),v=n(769),S=n(871),T=n(872),I=n(581),M=n(771),N=n(874),P=n(766),L=n(875),w=n(772),x=n(876),A=n(877),k=n(878),C=n(879),R=n(880),F=n(881),D=n(883),U=n(884),G=n(885),B=n(890),K=n(775),V=n(891),j=function(){function e(mask){this.mask=mask}return e.prototype.toCanvasImageSource=function(){return o(this,void 0,void 0,(function(){return l(this,(function(e){return[2,P.toHTMLCanvasElementLossy(this.mask)]}))}))},e.prototype.toImageData=function(){return o(this,void 0,void 0,(function(){return l(this,(function(e){return[2,P.toImageDataLossy(this.mask)]}))}))},e.prototype.toTensor=function(){return o(this,void 0,void 0,(function(){return l(this,(function(e){return[2,this.mask]}))}))},e.prototype.getUnderlyingType=function(){return"tensor"},e}();function z(e){return P.assertMaskValue(e),"person"}var H=function(){function e(e,t,n,r,o,l){this.detectorModel=e,this.landmarkModel=t,this.enableSmoothing=n,this.enableSegmentation=r,this.smoothSegmentation=o,this.modelType=l,this.regionOfInterest=null,this.prevFilteredSegmentationMask=null,this.anchors=S.createSsdAnchors(K.BLAZEPOSE_DETECTOR_ANCHOR_CONFIGURATION);var c=h.tensor1d(this.anchors.map((function(a){return a.width}))),f=h.tensor1d(this.anchors.map((function(a){return a.height}))),d=h.tensor1d(this.anchors.map((function(a){return a.xCenter}))),_=h.tensor1d(this.anchors.map((function(a){return a.yCenter})));this.anchorTensor={x:d,y:_,w:c,h:f},this.prevFilteredSegmentationMask=this.enableSegmentation?h.tensor2d([],[0,0]):null}return e.prototype.estimatePoses=function(image,e,t){return o(this,void 0,void 0,(function(){var n,r,o,c,d,_,y,m,O,v,S,T,N,P,L,x,A,k,C,R,F,D,U;return l(this,(function(l){switch(l.label){case 0:return n=V.validateEstimationConfig(e),null==image?(this.reset(),[2,[]]):(this.maxPoses=n.maxPoses,this.timestamp=null!=t?t*E.MILLISECOND_TO_MICRO_SECONDS:M.isVideo(image)?image.currentTime*E.SECOND_TO_MICRO_SECONDS:null,r=I.getImageSize(image),o=h.tidy((function(){return h.cast(I.toImageTensor(image),"float32")})),null!=(c=this.regionOfInterest)?[3,2]:[4,this.detectPose(o)]);case 1:if(0===(d=l.sent()).length)return this.reset(),o.dispose(),[2,[]];_=d[0],c=this.poseDetectionToRoi(_,r),l.label=2;case 2:return[4,this.poseLandmarksByRoi(c,o)];case 3:return y=l.sent(),o.dispose(),null==y?(this.reset(),[2,[]]):(m=y.landmarks,O=y.auxiliaryLandmarks,v=y.poseScore,S=y.worldLandmarks,T=y.segmentationMask,N=this.poseLandmarkFiltering(m,O,S,r),P=N.actualLandmarksFiltered,L=N.auxiliaryLandmarksFiltered,x=N.actualWorldLandmarksFiltered,A=this.poseLandmarksToRoi(L,r),this.regionOfInterest=A,k=this.smoothSegmentation&&null!=T?this.poseSegmentationFiltering(T):T,null!=(C=null!=P?w.normalizedKeypointsToKeypoints(P,r):null)&&C.forEach((function(e,i){e.name=f.BLAZEPOSE_KEYPOINTS[i]})),null!=(R=x)&&R.forEach((function(e,i){e.name=f.BLAZEPOSE_KEYPOINTS[i]})),F={score:v,keypoints:C,keypoints3D:R},null!==k&&(D=h.tidy((function(){var e=h.expandDims(k,2),t=h.pad(e,[[0,0],[0,0],[0,1]]);return h.mirrorPad(t,[[0,0],[0,0],[0,2]],"symmetric")})),this.smoothSegmentation||h.dispose(k),U={maskValueToLabel:z,mask:new j(D)},F.segmentation=U),[2,[F]])}}))}))},e.prototype.poseSegmentationFiltering=function(e){var t=this.prevFilteredSegmentationMask;return 0===t.size?this.prevFilteredSegmentationMask=e:(this.prevFilteredSegmentationMask=C.smoothSegmentation(t,e,K.BLAZEPOSE_SEGMENTATION_SMOOTHING_CONFIG),h.dispose(e)),h.dispose(t),this.prevFilteredSegmentationMask},e.prototype.dispose=function(){this.detectorModel.dispose(),this.landmarkModel.dispose(),h.dispose([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h,this.prevFilteredSegmentationMask])},e.prototype.reset=function(){this.regionOfInterest=null,this.enableSegmentation&&(h.dispose(this.prevFilteredSegmentationMask),this.prevFilteredSegmentationMask=h.tensor2d([],[0,0])),this.visibilitySmoothingFilterActual=null,this.visibilitySmoothingFilterAuxiliary=null,this.landmarksSmoothingFilterActual=null,this.landmarksSmoothingFilterAuxiliary=null},e.prototype.detectPose=function(image){return o(this,void 0,void 0,(function(){var e,t,n,r,o,c,f,d,_;return l(this,(function(l){switch(l.label){case 0:return e=v.convertImageToTensor(image,K.BLAZEPOSE_DETECTOR_IMAGE_TO_TENSOR_CONFIG),t=e.imageTensor,n=e.padding,r=T.detectorInference(t,this.detectorModel),o=r.boxes,c=r.logits,[4,R.tensorsToDetections([c,o],this.anchorTensor,K.BLAZEPOSE_TENSORS_TO_DETECTION_CONFIGURATION)];case 1:return 0===(f=l.sent()).length?(h.dispose([t,c,o]),[2,f]):[4,L.nonMaxSuppression(f,this.maxPoses,K.BLAZEPOSE_DETECTOR_NON_MAX_SUPPRESSION_CONFIGURATION.minSuppressionThreshold,K.BLAZEPOSE_DETECTOR_NON_MAX_SUPPRESSION_CONFIGURATION.overlapType)];case 2:return d=l.sent(),_=A.removeDetectionLetterbox(d,n),h.dispose([t,c,o]),[2,_]}}))}))},e.prototype.poseDetectionToRoi=function(e,t){var n=d.calculateAlignmentPointsRects(e,t,{rotationVectorEndKeypointIndex:1,rotationVectorStartKeypointIndex:0,rotationVectorTargetAngleDegree:90});return U.transformNormalizedRect(n,t,K.BLAZEPOSE_DETECTOR_RECT_TRANSFORMATION_CONFIG)},e.prototype.poseLandmarksByRoi=function(e,image){return o(this,void 0,void 0,(function(){var t,n,o,c,f,d,_,y,m,O,E,S,T,M;return l(this,(function(l){switch(l.label){case 0:if(t=I.getImageSize(image),n=v.convertImageToTensor(image,K.BLAZEPOSE_LANDMARK_IMAGE_TO_TENSOR_CONFIG,e),o=n.imageTensor,c=n.padding,f=n.transformationMatrix,"lite"!==this.modelType&&"full"!==this.modelType&&"heavy"!==this.modelType)throw new Error("Model type must be one of lite, full or heavy,but got "+this.modelType);return d=["ld_3d","output_poseflag","activation_heatmap","world_3d"],this.enableSegmentation&&d.push("activation_segmentation"),_=this.landmarkModel.execute(o,d),[4,this.tensorsToPoseLandmarksAndSegmentation(_)];case 1:return null==(y=l.sent())?(h.dispose(_),h.dispose(o),[2,null]):(m=y.landmarks,O=y.auxiliaryLandmarks,E=y.poseScore,S=y.worldLandmarks,T=y.segmentationMask,[4,this.poseLandmarksAndSegmentationInverseProjection(t,e,c,f,m,O,S,T)]);case 2:return M=l.sent(),h.dispose(_),h.dispose(o),[2,r({poseScore:E},M)]}}))}))},e.prototype.poseLandmarksAndSegmentationInverseProjection=function(e,t,n,r,c,f,d,m){return o(this,void 0,void 0,(function(){var o,E,v,S,T,M;return l(this,(function(l){return o=k.removeLandmarkLetterbox(c,n),E=k.removeLandmarkLetterbox(f,n),v=y.calculateLandmarkProjection(o,t),S=y.calculateLandmarkProjection(E,t),T=O.calculateWorldLandmarkProjection(d,t),M=null,this.enableSegmentation&&(M=h.tidy((function(){var t=m.shape,n=t[0],o=t[1],l=_.calculateInverseMatrix(r),c=h.tensor2d(I.getProjectiveTransformMatrix(l,{width:o,height:n},e),[1,8]),f=[1,n,o,1];return h.squeeze(h.image.transform(h.reshape(m,f),c,"bilinear","constant",0,[e.height,e.width]),[0,3])})),h.dispose(m)),[2,{landmarks:v,auxiliaryLandmarks:S,worldLandmarks:T,segmentationMask:M}]}))}))},e.prototype.tensorsToPoseLandmarksAndSegmentation=function(e){return o(this,void 0,void 0,(function(){var t,n,r,o,c,h,f,d,_,y,O,E,v,S;return l(this,(function(l){switch(l.label){case 0:return t=e[0],n=e[1],r=e[2],o=e[3],c=this.enableSegmentation?e[4]:null,[4,n.data()];case 1:return(h=l.sent()[0])<K.BLAZEPOSE_POSE_PRESENCE_SCORE?[2,null]:[4,F.tensorsToLandmarks(t,K.BLAZEPOSE_TENSORS_TO_LANDMARKS_CONFIG)];case 2:return f=l.sent(),[4,x.refineLandmarksFromHeatmap(f,r,K.BLAZEPOSE_REFINE_LANDMARKS_FROM_HEATMAP_CONFIG)];case 3:return d=l.sent(),_=d.slice(0,K.BLAZEPOSE_NUM_KEYPOINTS),y=d.slice(K.BLAZEPOSE_NUM_KEYPOINTS,K.BLAZEPOSE_NUM_AUXILIARY_KEYPOINTS),[4,F.tensorsToLandmarks(o,K.BLAZEPOSE_TENSORS_TO_WORLD_LANDMARKS_CONFIG)];case 4:return O=l.sent(),E=O.slice(0,K.BLAZEPOSE_NUM_KEYPOINTS),v=m.calculateScoreCopy(_,E,!0),S=this.enableSegmentation?D.tensorsToSegmentation(c,K.BLAZEPOSE_TENSORS_TO_SEGMENTATION_CONFIG):null,[2,{landmarks:_,auxiliaryLandmarks:y,poseScore:h,worldLandmarks:v,segmentationMask:S}]}}))}))},e.prototype.poseLandmarksToRoi=function(e,t){var n=N.landmarksToDetection(e),r=d.calculateAlignmentPointsRects(n,t,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:1,rotationVectorTargetAngleDegree:90});return U.transformNormalizedRect(r,t,K.BLAZEPOSE_DETECTOR_RECT_TRANSFORMATION_CONFIG)},e.prototype.poseLandmarkFiltering=function(e,t,n,r){var o,l,c;if(null!=this.timestamp&&this.enableSmoothing){var h=N.landmarksToDetection(t),f=d.calculateAlignmentPointsRects(h,r,{rotationVectorEndKeypointIndex:0,rotationVectorStartKeypointIndex:1,rotationVectorTargetAngleDegree:90});null==this.visibilitySmoothingFilterActual&&(this.visibilitySmoothingFilterActual=new B.LowPassVisibilityFilter(K.BLAZEPOSE_VISIBILITY_SMOOTHING_CONFIG)),o=this.visibilitySmoothingFilterActual.apply(e),null==this.visibilitySmoothingFilterAuxiliary&&(this.visibilitySmoothingFilterAuxiliary=new B.LowPassVisibilityFilter(K.BLAZEPOSE_VISIBILITY_SMOOTHING_CONFIG)),l=this.visibilitySmoothingFilterAuxiliary.apply(t),c=this.visibilitySmoothingFilterActual.apply(n),null==this.landmarksSmoothingFilterActual&&(this.landmarksSmoothingFilterActual=new G.KeypointsSmoothingFilter(K.BLAZEPOSE_LANDMARKS_SMOOTHING_CONFIG_ACTUAL)),o=this.landmarksSmoothingFilterActual.apply(o,this.timestamp,r,!0,f),null==this.landmarksSmoothingFilterAuxiliary&&(this.landmarksSmoothingFilterAuxiliary=new G.KeypointsSmoothingFilter(K.BLAZEPOSE_LANDMARKS_SMOOTHING_CONFIG_AUXILIARY)),l=this.landmarksSmoothingFilterAuxiliary.apply(l,this.timestamp,r,!0,f),null==this.worldLandmarksSmoothingFilterActual&&(this.worldLandmarksSmoothingFilterActual=new G.KeypointsSmoothingFilter(K.BLAZEPOSE_WORLD_LANDMARKS_SMOOTHING_CONFIG_ACTUAL)),c=this.worldLandmarksSmoothingFilterActual.apply(n,this.timestamp)}else o=e,l=t,c=n;return{actualLandmarksFiltered:o,auxiliaryLandmarksFiltered:l,actualWorldLandmarksFiltered:c}},e}();t.load=function(e){return o(this,void 0,void 0,(function(){var t,n,r,o,h,f;return l(this,(function(l){switch(l.label){case 0:return t=V.validateModelConfig(e),n="string"==typeof t.detectorModelUrl&&t.detectorModelUrl.indexOf("https://tfhub.dev")>-1,r="string"==typeof t.landmarkModelUrl&&t.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,Promise.all([c.loadGraphModel(t.detectorModelUrl,{fromTFHub:n}),c.loadGraphModel(t.landmarkModelUrl,{fromTFHub:r})])];case 1:return o=l.sent(),h=o[0],f=o[1],[2,new H(h,f,t.enableSmoothing,t.enableSegmentation,t.smoothSegmentation,t.modelType)]}}))}))}},865:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateAlignmentPointsRects=void 0;var r=n(866);t.calculateAlignmentPointsRects=function(e,t,n){var o=n.rotationVectorStartKeypointIndex,l=n.rotationVectorEndKeypointIndex,c=e.locationData,h=c.relativeKeypoints[o].x*t.width,f=c.relativeKeypoints[o].y*t.height,d=c.relativeKeypoints[l].x*t.width,_=c.relativeKeypoints[l].y*t.height,y=2*Math.sqrt((d-h)*(d-h)+(_-f)*(_-f)),m=r.computeRotation(e,t,n);return{xCenter:h/t.width,yCenter:f/t.height,width:y/t.width,height:y/t.height,rotation:m}}},866:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateDetectionsToRects=t.computeRotation=void 0;var r=n(581);function o(e,t,n){var o,l=e.locationData,c=n.rotationVectorStartKeypointIndex,h=n.rotationVectorEndKeypointIndex;o=n.rotationVectorTargetAngle?n.rotationVectorTargetAngle:Math.PI*n.rotationVectorTargetAngleDegree/180;var f=l.relativeKeypoints[c].x*t.width,d=l.relativeKeypoints[c].y*t.height,_=l.relativeKeypoints[h].x*t.width,y=l.relativeKeypoints[h].y*t.height;return r.normalizeRadians(o-Math.atan2(-(y-d),_-f))}function l(e){return{xCenter:e.xMin+e.width/2,yCenter:e.yMin+e.height/2,width:e.width,height:e.height}}function c(e){var t=e.relativeKeypoints;if(t.length<=1)throw new Error("2 or more keypoints required to calculate a rect.");var n=Number.MAX_VALUE,r=Number.MAX_VALUE,o=Number.MIN_VALUE,l=Number.MIN_VALUE;return t.forEach((function(e){n=Math.min(n,e.x),o=Math.max(o,e.x),r=Math.min(r,e.y),l=Math.max(l,e.y)})),{xCenter:(n+o)/2,yCenter:(r+l)/2,width:o-n,height:l-r}}t.computeRotation=o,t.calculateDetectionsToRects=function(e,t,n,r,h){var rect="rect"===n?function(e,t,n){var rect,r=e.locationData;if("boundingbox"===t)rect=l(r.boundingBox);else{rect=c(r);var o=n.width,h=n.height;rect.xCenter=Math.round(rect.xCenter*o),rect.yCenter=Math.round(rect.yCenter*h),rect.width=Math.round(rect.width*o),rect.height=Math.round(rect.height*h)}return rect}(e,t,r):function(e,t){var n=e.locationData;return"boundingbox"===t?l(n.relativeBoundingBox):c(n)}(e,t);return h&&(rect.rotation=o(e,r,h)),rect}},867:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.calculateLandmarkProjection=void 0,t.calculateLandmarkProjection=function(e,t,n){void 0===n&&(n={ignoreRotation:!1});for(var o=[],l=0,c=e;l<c.length;l++){var h=c[l],f=h.x-.5,d=h.y-.5,_=n.ignoreRotation?0:t.rotation,y=Math.cos(_)*f-Math.sin(_)*d,m=Math.sin(_)*f+Math.cos(_)*d;y=y*t.width+t.xCenter,m=m*t.height+t.yCenter;var O=h.z*t.width,E=r({},h);E.x=y,E.y=m,E.z=O,o.push(E)}return o}},868:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.calculateScoreCopy=void 0,t.calculateScoreCopy=function(e,t,n){void 0===n&&(n=!0);for(var o=[],i=0;i<e.length;i++){var l=r({},t[i]);n&&(l.score=e[i].score),o.push(l)}return o}},869:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.calculateWorldLandmarkProjection=void 0,t.calculateWorldLandmarkProjection=function(e,t){for(var n=[],o=0,l=e;o<l.length;o++){var c=l[o],h=c.x,f=c.y,d=t.rotation,_=Math.cos(d)*h-Math.sin(d)*f,y=Math.sin(d)*h+Math.cos(d)*f,m=r({},c);m.x=_,m.y=y,n.push(m)}return n}},870:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRotatedSubRectToRectTransformMatrix=void 0;var r=n(768);t.getRotatedSubRectToRectTransformMatrix=function(e,t,n,o){var a=e.width,b=e.height,l=o?-1:1,c=Math.cos(e.rotation),h=Math.sin(e.rotation),f=e.xCenter,d=e.yCenter,g=1/t,_=1/n,y=new Array(16);return y[0]=a*c*l*g,y[1]=-b*h*g,y[2]=0,y[3]=(-.5*a*c*l+.5*b*h+f)*g,y[4]=a*h*l*_,y[5]=b*c*_,y[6]=0,y[7]=(-.5*b*c-.5*a*h*l+d)*_,y[8]=0,y[9]=0,y[10]=a*g,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,r.arrayToMatrix4x4(y)}},871:function(e,t,n){"use strict";function r(e,t,n,r){return 1===r?.5*(e+t):e+(t-e)*n/(r-1)}Object.defineProperty(t,"__esModule",{value:!0}),t.createSsdAnchors=void 0,t.createSsdAnchors=function(e){null==e.reduceBoxesInLowestLayer&&(e.reduceBoxesInLowestLayer=!1),null==e.interpolatedScaleAspectRatio&&(e.interpolatedScaleAspectRatio=1),null==e.fixedAnchorSize&&(e.fixedAnchorSize=!1);for(var t=[],n=0;n<e.numLayers;){for(var o=[],l=[],c=[],h=[],f=n;f<e.strides.length&&e.strides[f]===e.strides[n];){var d=r(e.minScale,e.maxScale,f,e.strides.length);if(0===f&&e.reduceBoxesInLowestLayer)c.push(1),c.push(2),c.push(.5),h.push(.1),h.push(d),h.push(d);else{for(var _=0;_<e.aspectRatios.length;++_)c.push(e.aspectRatios[_]),h.push(d);if(e.interpolatedScaleAspectRatio>0){var y=f===e.strides.length-1?1:r(e.minScale,e.maxScale,f+1,e.strides.length);h.push(Math.sqrt(d*y)),c.push(e.interpolatedScaleAspectRatio)}}f++}for(var i=0;i<c.length;++i){var m=Math.sqrt(c[i]);o.push(h[i]/m),l.push(h[i]*m)}var O=0,E=0;if(e.featureMapHeight.length>0)O=e.featureMapHeight[n],E=e.featureMapWidth[n];else{var v=e.strides[n];O=Math.ceil(e.inputSizeHeight/v),E=Math.ceil(e.inputSizeWidth/v)}for(var S=0;S<O;++S)for(var T=0;T<E;++T)for(var I=0;I<o.length;++I){var M={xCenter:(T+e.anchorOffsetX)/E,yCenter:(S+e.anchorOffsetY)/O,width:0,height:0};e.fixedAnchorSize?(M.width=1,M.height=1):(M.width=l[I],M.height=o[I]),t.push(M)}n=f}return t}},872:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detectorInference=void 0;var r=n(545),o=n(873);t.detectorInference=function(e,t){return r.tidy((function(){var n=t.predict(e),l=o.splitDetectionResult(n),c=l[0],h=l[1];return{boxes:r.squeeze(h),logits:r.squeeze(c)}}))}},873:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitDetectionResult=void 0;var r=n(545);t.splitDetectionResult=function(e){return r.tidy((function(){return[r.slice(e,[0,0,0],[1,-1,1]),r.slice(e,[0,0,1],[1,-1,-1])]}))}},874:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.landmarksToDetection=void 0,t.landmarksToDetection=function(e){for(var t={locationData:{relativeKeypoints:[]}},n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER,i=0;i<e.length;++i){var c=e[i];n=Math.min(n,c.x),r=Math.max(r,c.x),o=Math.min(o,c.y),l=Math.max(l,c.y),t.locationData.relativeKeypoints.push({x:c.x,y:c.y})}return t.locationData.relativeBoundingBox={xMin:n,yMin:o,xMax:r,yMax:l,width:r-n,height:l-o},t}},875:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{f(r.next(e))}catch(e){l(e)}}function h(e){try{f(r.throw(e))}catch(e){l(e)}}function f(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,h)}f((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.nonMaxSuppression=void 0;var l=n(545);t.nonMaxSuppression=function(e,t,n,c){return r(this,void 0,void 0,(function(){var r,c,h,f,d;return o(this,(function(o){switch(o.label){case 0:return e.sort((function(e,t){return Math.max.apply(Math,t.score)-Math.max.apply(Math,e.score)})),r=l.tensor2d(e.map((function(e){return[e.locationData.relativeBoundingBox.yMin,e.locationData.relativeBoundingBox.xMin,e.locationData.relativeBoundingBox.yMax,e.locationData.relativeBoundingBox.xMax]}))),c=l.tensor1d(e.map((function(e){return e.score[0]}))),[4,l.image.nonMaxSuppressionAsync(r,c,t,n)];case 1:return[4,(h=o.sent()).array()];case 2:return f=o.sent(),d=e.filter((function(e,i){return f.indexOf(i)>-1})),l.dispose([r,c,h]),[2,d]}}))}))}},876:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{f(r.next(e))}catch(e){l(e)}}function h(e){try{f(r.throw(e))}catch(e){l(e)}}function f(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,h)}f((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.refineLandmarksFromHeatmap=void 0;var c=n(545);t.refineLandmarksFromHeatmap=function(e,t,n){return o(this,void 0,void 0,(function(){var o,h,f,d,_,y,m,i,O,E,v,S,T,I,M,N,P,L,w,x,A,k,col,C;return l(this,(function(l){switch(l.label){case 0:if(o=c.squeeze(t,[0]),h=o.shape,f=h[0],d=h[1],_=h[2],e.length!==_)throw new Error("Expected heatmap to have same number of channels as the number of landmarks. But got landmarks length: "+e.length+", heatmap length: "+_);return y=[],[4,o.buffer()];case 1:for(m=l.sent(),i=0;i<e.length;i++)if(O=e[i],E=r({},O),y.push(E),v=Math.trunc(E.x*d),S=Math.trunc(E.y*f),!(v<0||v>=d||S<0||v>=f)){for(T=Math.trunc((n.kernelSize-1)/2),I=Math.max(0,v-T),M=Math.min(d,v+T+1),N=Math.max(0,S-T),P=Math.min(f,S+T+1),L=0,w=0,x=0,A=0,k=N;k<P;++k)for(col=I;col<M;++col)C=m.get(k,col,i),L+=C,A=Math.max(A,C),w+=col*C,x+=k*C;A>=n.minConfidenceToRefine&&L>0&&(E.x=w/d/L,E.y=x/f/L)}return o.dispose(),[2,y]}}))}))}},877:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeDetectionLetterbox=void 0,t.removeDetectionLetterbox=function(e,t){void 0===e&&(e=[]);for(var n=t.left,r=t.top,o=t.left+t.right,l=t.top+t.bottom,i=0;i<e.length;i++){var c=e[i],h=c.locationData.relativeBoundingBox,f=(h.xMin-n)/(1-o),d=(h.yMin-r)/(1-l),_=h.width/(1-o),y=h.height/(1-l);h.xMin=f,h.yMin=d,h.width=_,h.height=y,h.xMax=f+_,h.yMax=d+y;var m=c.locationData.relativeKeypoints;m&&m.forEach((function(e){var t=(e.x-n)/(1-o),c=(e.y-r)/(1-l);e.x=t,e.y=c}))}return e}},878:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.removeLandmarkLetterbox=void 0,t.removeLandmarkLetterbox=function(e,t){var n=t.left,o=t.top,l=t.left+t.right,c=t.top+t.bottom;return e.map((function(e){return r(r({},e),{x:(e.x-n)/(1-l),y:(e.y-o)/(1-c),z:e.z/(1-l)})}))}},879:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.smoothSegmentation=void 0;var r=n(545);t.smoothSegmentation=function(e,t,n){return"webgl"===r.getBackend()?function(e,t,n){var o=n.combineWithPreviousRatio.toFixed(2),l={variableNames:["prevMask","newMask"],outputShape:e.shape,userCode:"\n  void main() {\n      ivec2 coords = getOutputCoords();\n      int height = coords[0];\n      int width = coords[1];\n\n      float prevMaskValue = getPrevMask(height, width);\n      float newMaskValue = getNewMask(height, width);\n\n      /*\n      * Assume p := newMaskValue\n      * H(p) := 1 + (p * log(p) + (1-p) * log(1-p)) / log(2)\n      * uncertainty alpha(p) =\n      *   Clamp(1 - (1 - H(p)) * (1 - H(p)), 0, 1) [squaring the\n      * uncertainty]\n      *\n      * The following polynomial approximates uncertainty alpha as a\n      * function of (p + 0.5):\n      */\n      const float c1 = 5.68842;\n      const float c2 = -0.748699;\n      const float c3 = -57.8051;\n      const float c4 = 291.309;\n      const float c5 = -624.717;\n      float t = newMaskValue - 0.5;\n      float x = t * t;\n\n      float uncertainty =\n        1.0 - min(1.0, x * (c1 + x * (c2 + x * (c3 + x * (c4 + x * c5)))));\n\n      float outputValue = newMaskValue + (prevMaskValue - newMaskValue) *\n                             (uncertainty * "+o+");\n\n      setOutput(outputValue);\n    }\n"},c=r.backend();return r.tidy((function(){var n=c.compileAndRun(l,[e,t]);return r.engine().makeTensorFromDataId(n.dataId,n.shape,n.dtype)}))}(e,t,n):r.tidy((function(){var o=r.sub(t,.5),l=r.square(o),c=r.sub(1,r.minimum(1,r.mul(l,r.add(5.68842,r.mul(l,r.add(-.748699,r.mul(l,r.add(-57.8051,r.mul(l,r.add(291.309,r.mul(l,-624.717)))))))))));return r.add(t,r.mul(r.sub(e,t),r.mul(c,n.combineWithPreviousRatio)))}))}},880:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{f(r.next(e))}catch(e){l(e)}}function h(e){try{f(r.throw(e))}catch(e){l(e)}}function f(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,h)}f((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.convertToDetections=t.tensorsToDetections=void 0;var l=n(545);function c(e,t,n){return r(this,void 0,void 0,(function(){var r,l,c,i,f,d,_,y,m,O,E,v;return o(this,(function(o){switch(o.label){case 0:return r=[],[4,e.data()];case 1:return l=o.sent(),[4,t.data()];case 2:for(c=o.sent(),i=0;i<n.numBoxes;++i)if(!(null!=n.minScoreThresh&&c[i]<n.minScoreThresh||(f=i*n.numCoords,d=h(l[f+0],l[f+1],l[f+2],l[f+3],c[i],n.flipVertically,i),(_=d.locationData.relativeBoundingBox).width<0||_.height<0))){if(n.numKeypoints>0)for((y=d.locationData).relativeKeypoints=[],m=n.numKeypoints*n.numValuesPerKeypoint,O=0;O<m;O+=n.numValuesPerKeypoint)E=f+n.keypointCoordOffset+O,v={x:l[E+0],y:n.flipVertically?1-l[E+1]:l[E+1]},y.relativeKeypoints.push(v);r.push(d)}return[2,r]}}))}))}function h(e,t,n,r,o,l,i){return{score:[o],ind:i,locationData:{relativeBoundingBox:{xMin:t,yMin:l?1-n:e,xMax:r,yMax:l?1-e:n,width:r-t,height:n-e}}}}t.tensorsToDetections=function(e,t,n){return r(this,void 0,void 0,(function(){var r,h,f,d,_;return o(this,(function(o){switch(o.label){case 0:return r=e[0],h=e[1],f=function(e,t,n){return l.tidy((function(){var r,o,c,h;n.reverseOutputOrder?(o=l.squeeze(l.slice(e,[0,n.boxCoordOffset+0],[-1,1])),r=l.squeeze(l.slice(e,[0,n.boxCoordOffset+1],[-1,1])),h=l.squeeze(l.slice(e,[0,n.boxCoordOffset+2],[-1,1])),c=l.squeeze(l.slice(e,[0,n.boxCoordOffset+3],[-1,1]))):(r=l.squeeze(l.slice(e,[0,n.boxCoordOffset+0],[-1,1])),o=l.squeeze(l.slice(e,[0,n.boxCoordOffset+1],[-1,1])),c=l.squeeze(l.slice(e,[0,n.boxCoordOffset+2],[-1,1])),h=l.squeeze(l.slice(e,[0,n.boxCoordOffset+3],[-1,1]))),o=l.add(l.mul(l.div(o,n.xScale),t.w),t.x),r=l.add(l.mul(l.div(r,n.yScale),t.h),t.y),n.applyExponentialOnBoxSize?(c=l.mul(l.exp(l.div(c,n.hScale)),t.h),h=l.mul(l.exp(l.div(h,n.wScale)),t.w)):(c=l.mul(l.div(c,n.hScale),t.h),h=l.mul(l.div(h,n.wScale),t.h));var f=l.sub(r,l.div(c,2)),d=l.sub(o,l.div(h,2)),_=l.add(r,l.div(c,2)),y=l.add(o,l.div(h,2)),m=l.concat([l.reshape(f,[n.numBoxes,1]),l.reshape(d,[n.numBoxes,1]),l.reshape(_,[n.numBoxes,1]),l.reshape(y,[n.numBoxes,1])],1);if(n.numKeypoints)for(var O=0;O<n.numKeypoints;++O){var E=n.keypointCoordOffset+O*n.numValuesPerKeypoint,v=void 0,S=void 0;n.reverseOutputOrder?(v=l.squeeze(l.slice(e,[0,E],[-1,1])),S=l.squeeze(l.slice(e,[0,E+1],[-1,1]))):(S=l.squeeze(l.slice(e,[0,E],[-1,1])),v=l.squeeze(l.slice(e,[0,E+1],[-1,1])));var T=l.add(l.mul(l.div(v,n.xScale),t.w),t.x),I=l.add(l.mul(l.div(S,n.yScale),t.h),t.y);m=l.concat([m,l.reshape(T,[n.numBoxes,1]),l.reshape(I,[n.numBoxes,1])],1)}return m}))}(h,t,n),d=l.tidy((function(){var e=r;return n.sigmoidScore?(null!=n.scoreClippingThresh&&(e=l.clipByValue(r,-n.scoreClippingThresh,n.scoreClippingThresh)),e=l.sigmoid(e)):e})),[4,c(f,d,n)];case 1:return _=o.sent(),l.dispose([f,d]),[2,_]}}))}))},t.convertToDetections=c},881:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{f(r.next(e))}catch(e){l(e)}}function h(e){try{f(r.throw(e))}catch(e){l(e)}}function f(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,h)}f((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.tensorsToLandmarks=void 0;var l=n(882);t.tensorsToLandmarks=function(e,t,n,c){return r(this,void 0,void 0,(function(){var r,h,f,d,_,y,i,m;return o(this,(function(o){switch(o.label){case 0:return n=n||t.flipHorizontally||!1,c=c||t.flipVertically||!1,r=e.size,h=r/t.numLandmarks,[4,e.data()];case 1:for(f=o.sent(),d=[],_=0;_<t.numLandmarks;++_)y=_*h,(m={x:0,y:0}).x=n?t.inputImageWidth-f[y]:f[y],h>1&&(m.y=c?t.inputImageHeight-f[y+1]:f[y+1]),h>2&&(m.z=f[y+2]),h>3&&(m.score=(O=t.visibilityActivation,E=f[y+3],"none"===O?E:l.sigmoid(E))),d.push(m);for(i=0;i<d.length;++i)(m=d[i]).x=m.x/t.inputImageWidth,m.y=m.y/t.inputImageHeight,m.z=m.z/t.inputImageWidth/(t.normalizeZ||1);return[2,d]}var O,E}))}))}},882:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sigmoid=void 0,t.sigmoid=function(e){return 1/(1+Math.exp(-e))}},883:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tensorsToSegmentation=void 0;var r=n(545);t.tensorsToSegmentation=function(e,t,n){return r.tidy((function(){var o=r.squeeze(e,[0]),l=o.shape[2];if(1===l){var c=o;switch(t.activation){case"none":break;case"sigmoid":c=r.sigmoid(c);break;case"softmax":throw new Error("Softmax activation requires two channels.");default:throw new Error("Activation not supported ("+t.activation+")")}var h=n?r.image.resizeBilinear(c,[n.height,n.width]):c;return r.squeeze(h,[2])}throw new Error("Unsupported number of tensor channels "+l)}))}},884:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeNewRotation=t.transformNormalizedRect=void 0;var r=n(581);function o(e,t){return null!=t.rotation?e+=t.rotation:null!=t.rotationDegree&&(e+=Math.PI*t.rotationDegree/180),r.normalizeRadians(e)}t.transformNormalizedRect=function(rect,e,t){var n=rect.width,r=rect.height,l=rect.rotation;if(null==t.rotation&&null==t.rotationDegree||(l=o(l,t)),0===l)rect.xCenter=rect.xCenter+n*t.shiftX,rect.yCenter=rect.yCenter+r*t.shiftY;else{var c=(e.width*n*t.shiftX*Math.cos(l)-e.height*r*t.shiftY*Math.sin(l))/e.width,h=(e.width*n*t.shiftX*Math.sin(l)+e.height*r*t.shiftY*Math.cos(l))/e.height;rect.xCenter=rect.xCenter+c,rect.yCenter=rect.yCenter+h}if(t.squareLong){var f=Math.max(n*e.width,r*e.height);n=f/e.width,r=f/e.height}else if(t.squareShort){var d=Math.min(n*e.width,r*e.height);n=d/e.width,r=d/e.height}return rect.width=n*t.scaleX,rect.height=r*t.scaleY,rect},t.computeNewRotation=o},885:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeypointsSmoothingFilter=void 0;var r=n(886),o=n(773),l=n(772),c=n(774),h=n(888),f=function(){function e(e){if(null!=e.velocityFilter)this.keypointsFilter=new h.KeypointsVelocityFilter(e.velocityFilter);else{if(null==e.oneEuroFilter)throw new Error("Either configure velocityFilter or oneEuroFilter, but got "+e+".");this.keypointsFilter=new c.KeypointsOneEuroFilter(e.oneEuroFilter)}}return e.prototype.apply=function(e,t,n,c,h){if(void 0===c&&(c=!1),null==e)return this.keypointsFilter.reset(),null;var f=null!=h?r.getObjectScale(h,n):1,d=c?l.normalizedKeypointsToKeypoints(e,n):e,_=this.keypointsFilter.apply(d,t,f);return c?o.keypointsToNormalizedKeypoints(_,n):_},e}();t.KeypointsSmoothingFilter=f},886:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getObjectScale=void 0,t.getObjectScale=function(e,t){return(e.width*t.width+e.height*t.height)/2}},887:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OneEuroFilter=void 0;var r=n(630),o=n(631),l=function(){function e(e){this.frequency=e.frequency,this.minCutOff=e.minCutOff,this.beta=e.beta,this.thresholdCutOff=e.thresholdCutOff,this.thresholdBeta=e.thresholdBeta,this.derivateCutOff=e.derivateCutOff,this.x=new o.LowPassFilter(this.getAlpha(this.minCutOff)),this.dx=new o.LowPassFilter(this.getAlpha(this.derivateCutOff)),this.lastTimestamp=0}return e.prototype.apply=function(e,t,n){if(null==e)return e;var o=Math.trunc(t);if(this.lastTimestamp>=o)return e;0!==this.lastTimestamp&&0!==o&&(this.frequency=1/((o-this.lastTimestamp)*r.MICRO_SECONDS_TO_SECOND)),this.lastTimestamp=o;var l=this.x.hasLastRawValue()?(e-this.x.lastRawValue())*n*this.frequency:0,c=this.dx.applyWithAlpha(l,this.getAlpha(this.derivateCutOff)),h=this.minCutOff+this.beta*Math.abs(c),f=null!=this.thresholdCutOff?this.thresholdCutOff+this.thresholdBeta*Math.abs(c):null;return this.x.applyWithAlpha(e,this.getAlpha(h),f)},e.prototype.getAlpha=function(e){return 1/(1+this.frequency/(2*Math.PI*e))},e}();t.OneEuroFilter=l},888:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},r.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var s=0,i=0,e=arguments.length;i<e;i++)s+=arguments[i].length;var t=Array(s),n=0;for(i=0;i<e;i++)for(var a=arguments[i],r=0,o=a.length;r<o;r++,n++)t[n]=a[r];return t};Object.defineProperty(t,"__esModule",{value:!0}),t.KeypointsVelocityFilter=void 0;var l=n(889),c=function(){function e(e){this.config=e}return e.prototype.apply=function(e,t,n){var l=this;if(null==e)return this.reset(),null;var c=1;if(!this.config.disableValueScaling){if(n<this.config.minAllowedObjectScale)return o(e);c=1/n}return this.initializeFiltersIfEmpty(e),e.map((function(e,i){var n=r(r({},e),{x:l.xFilters[i].apply(e.x,t,c),y:l.yFilters[i].apply(e.y,t,c)});return null!=e.z&&(n.z=l.zFilters[i].apply(e.z,t,c)),n}))},e.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},e.prototype.initializeFiltersIfEmpty=function(e){var t=this;null!=this.xFilters&&this.xFilters.length===e.length||(this.xFilters=e.map((function(e){return new l.RelativeVelocityFilter(t.config)})),this.yFilters=e.map((function(e){return new l.RelativeVelocityFilter(t.config)})),this.zFilters=e.map((function(e){return new l.RelativeVelocityFilter(t.config)})))},e}();t.KeypointsVelocityFilter=c},889:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RelativeVelocityFilter=void 0;var r=n(630),o=n(631),l=function(){function e(e){this.config=e,this.window=[],this.lowPassFilter=new o.LowPassFilter(1),this.lastValue=0,this.lastValueScale=1,this.lastTimestamp=-1}return e.prototype.apply=function(e,t,n){if(null==e)return e;var o,l=Math.trunc(t);if(this.lastTimestamp>=l)return e;if(-1===this.lastTimestamp)o=1;else{for(var c=e*n-this.lastValue*this.lastValueScale,h=l-this.lastTimestamp,f=c,d=h,_=r.SECOND_TO_MICRO_SECONDS/30,y=(1+this.window.length)*_,m=0,O=this.window;m<O.length;m++){var E=O[m];if(d+E.duration>y)break;f+=E.distance,d+=E.duration}var v=f/(d*r.MICRO_SECONDS_TO_SECOND);o=1-1/(1+this.config.velocityScale*Math.abs(v)),this.window.unshift({distance:c,duration:h}),this.window.length>this.config.windowSize&&this.window.pop()}return this.lastValue=e,this.lastValueScale=n,this.lastTimestamp=l,this.lowPassFilter.applyWithAlpha(e,o)},e}();t.RelativeVelocityFilter=l},890:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.LowPassVisibilityFilter=void 0;var o=n(631),l=function(){function e(e){this.alpha=e.alpha}return e.prototype.apply=function(e){var t=this;if(null==e)return this.visibilityFilters=null,null;null!=this.visibilityFilters&&this.visibilityFilters.length===e.length||(this.visibilityFilters=e.map((function(e){return new o.LowPassFilter(t.alpha)})));for(var n=[],i=0;i<e.length;++i){var l=e[i],c=r({},l);c.score=this.visibilityFilters[i].apply(l.score),n.push(c)}return n},e}();t.LowPassVisibilityFilter=l},891:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.validateEstimationConfig=t.validateModelConfig=void 0;var o=n(775);t.validateModelConfig=function(e){var t=r({},null==e?o.DEFAULT_BLAZEPOSE_MODEL_CONFIG:e);if(null==t.enableSmoothing&&(t.enableSmoothing=o.DEFAULT_BLAZEPOSE_MODEL_CONFIG.enableSmoothing),null==t.enableSegmentation&&(t.enableSegmentation=o.DEFAULT_BLAZEPOSE_MODEL_CONFIG.enableSegmentation),null==t.smoothSegmentation&&(t.smoothSegmentation=o.DEFAULT_BLAZEPOSE_MODEL_CONFIG.smoothSegmentation),null==t.modelType&&(t.modelType=o.DEFAULT_BLAZEPOSE_MODEL_CONFIG.modelType),null==t.detectorModelUrl&&(t.detectorModelUrl=o.DEFAULT_BLAZEPOSE_MODEL_CONFIG.detectorModelUrl),null==t.landmarkModelUrl)switch(t.modelType){case"lite":t.landmarkModelUrl=o.DEFAULT_BLAZEPOSE_LANDMARK_MODEL_URL_LITE;break;case"heavy":t.landmarkModelUrl=o.DEFAULT_BLAZEPOSE_LANDMARK_MODEL_URL_HEAVY;break;default:t.landmarkModelUrl=o.DEFAULT_BLAZEPOSE_LANDMARK_MODEL_URL_FULL}return t},t.validateEstimationConfig=function(e){var t;if(null==(t=null==e?o.DEFAULT_BLAZEPOSE_ESTIMATION_CONFIG:r({},e)).maxPoses&&(t.maxPoses=1),t.maxPoses<=0)throw new Error("Invalid maxPoses "+t.maxPoses+". Should be > 0.");if(t.maxPoses>1)throw new Error("Multi-pose detection is not implemented yet. Please set maxPoses to 1.");return t}},892:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{f(r.next(e))}catch(e){l(e)}}function h(e){try{f(r.throw(e))}catch(e){l(e)}}function f(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,h)}f((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.load=void 0;var l=n(637),c=n(545),h=n(893),f=n(895),d=n(678),_=n(573),y=n(630),m=n(581),O=n(771),E=n(774),v=n(631),S=n(632),T=n(777),I=n(633),M=n(896),N=n(897),P=function(){function e(e,t){this.moveNetModel=e,this.modelInputResolution={height:0,width:0},this.keypointIndexByName=T.getKeypointIndexByName(S.SupportedModels.MoveNet),t.modelType===I.SINGLEPOSE_LIGHTNING?(this.modelInputResolution.width=I.MOVENET_SINGLEPOSE_LIGHTNING_RESOLUTION,this.modelInputResolution.height=I.MOVENET_SINGLEPOSE_LIGHTNING_RESOLUTION):t.modelType===I.SINGLEPOSE_THUNDER&&(this.modelInputResolution.width=I.MOVENET_SINGLEPOSE_THUNDER_RESOLUTION,this.modelInputResolution.height=I.MOVENET_SINGLEPOSE_THUNDER_RESOLUTION),this.multiPoseModel=t.modelType===I.MULTIPOSE_LIGHTNING,this.multiPoseModel||(this.keypointFilter=new E.KeypointsOneEuroFilter(I.KEYPOINT_FILTER_CONFIG),this.cropRegionFilterYMin=new v.LowPassFilter(I.CROP_FILTER_ALPHA),this.cropRegionFilterXMin=new v.LowPassFilter(I.CROP_FILTER_ALPHA),this.cropRegionFilterYMax=new v.LowPassFilter(I.CROP_FILTER_ALPHA),this.cropRegionFilterXMax=new v.LowPassFilter(I.CROP_FILTER_ALPHA)),this.enableSmoothing=t.enableSmoothing,t.minPoseScore?this.minPoseScore=t.minPoseScore:this.minPoseScore=I.DEFAULT_MIN_POSE_SCORE,t.multiPoseMaxDimension?this.multiPoseMaxDimension=t.multiPoseMaxDimension:this.multiPoseMaxDimension=I.MOVENET_MULTIPOSE_DEFAULT_MAX_DIMENSION,this.enableTracking=t.enableTracking,this.multiPoseModel&&this.enableTracking&&(t.trackerType===d.TrackerType.Keypoint?this.tracker=new f.KeypointTracker(t.trackerConfig):t.trackerType===d.TrackerType.BoundingBox&&(this.tracker=new h.BoundingBoxTracker(t.trackerConfig)),this.enableSmoothing&&(this.keypointFilterMap=new Map))}return e.prototype.runSinglePersonPoseModel=function(e){return r(this,void 0,void 0,(function(){var t,n,r,l,i;return o(this,(function(o){switch(o.label){case 0:if(4!==(t=this.moveNetModel.execute(e)).shape.length||1!==t.shape[0]||1!==t.shape[1]||t.shape[2]!==I.NUM_KEYPOINTS||t.shape[3]!==I.NUM_KEYPOINT_VALUES)throw t.dispose(),new Error("Unexpected output shape from model: ["+t.shape+"]");return"webgpu"===c.getBackend()?[3,1]:(n=t.dataSync(),[3,3]);case 1:return[4,t.data()];case 2:n=o.sent(),o.label=3;case 3:for(t.dispose(),r={keypoints:[],score:0},l=0,i=0;i<I.NUM_KEYPOINTS;++i)r.keypoints[i]={y:n[i*I.NUM_KEYPOINT_VALUES],x:n[i*I.NUM_KEYPOINT_VALUES+1],score:n[i*I.NUM_KEYPOINT_VALUES+2]},r.keypoints[i].score>I.MIN_CROP_KEYPOINT_SCORE&&(++l,r.score+=r.keypoints[i].score);return l>0&&(r.score/=l),[2,r]}}))}))},e.prototype.runMultiPersonPoseModel=function(e){return r(this,void 0,void 0,(function(){var t,n,r,l,i,h,f,d;return o(this,(function(o){switch(o.label){case 0:if(3!==(t=this.moveNetModel.execute(e)).shape.length||1!==t.shape[0]||t.shape[2]!==I.MULTIPOSE_INSTANCE_SIZE)throw t.dispose(),new Error("Unexpected output shape from model: ["+t.shape+"]");return"webgpu"===c.getBackend()?[3,1]:(n=t.dataSync(),[3,3]);case 1:return[4,t.data()];case 2:n=o.sent(),o.label=3;case 3:for(t.dispose(),r=[],l=n.length/I.MULTIPOSE_INSTANCE_SIZE,i=0;i<l;++i)for(r[i]={keypoints:[]},h=i*I.MULTIPOSE_INSTANCE_SIZE+I.MULTIPOSE_BOX_IDX,r[i].box={yMin:n[h],xMin:n[h+1],yMax:n[h+2],xMax:n[h+3],width:n[h+3]-n[h+1],height:n[h+2]-n[h]},f=i*I.MULTIPOSE_INSTANCE_SIZE+I.MULTIPOSE_BOX_SCORE_IDX,r[i].score=n[f],r[i].keypoints=[],d=0;d<I.NUM_KEYPOINTS;++d)r[i].keypoints[d]={y:n[i*I.MULTIPOSE_INSTANCE_SIZE+d*I.NUM_KEYPOINT_VALUES],x:n[i*I.MULTIPOSE_INSTANCE_SIZE+d*I.NUM_KEYPOINT_VALUES+1],score:n[i*I.MULTIPOSE_INSTANCE_SIZE+d*I.NUM_KEYPOINT_VALUES+2]};return[2,r]}}))}))},e.prototype.estimatePoses=function(image,e,t){return void 0===e&&(e=I.MOVENET_ESTIMATION_CONFIG),r(this,void 0,void 0,(function(){var n,r,l,h,f,d;return o(this,(function(o){switch(o.label){case 0:return e=N.validateEstimationConfig(e),null==image?(this.reset(),[2,[]]):(null==t?O.isVideo(image)&&(t=image.currentTime*y.SECOND_TO_MICRO_SECONDS):t*=y.MILLISECOND_TO_MICRO_SECONDS,n=m.toImageTensor(image),r=m.getImageSize(n),l=c.expandDims(n,0),image instanceof c.Tensor||n.dispose(),h=[],this.multiPoseModel?[3,2]:[4,this.estimateSinglePose(l,r,t)]);case 1:return h=o.sent(),[3,4];case 2:return[4,this.estimateMultiplePoses(l,r,t)];case 3:h=o.sent(),o.label=4;case 4:for(f=0;f<h.length;++f)for(d=0;d<h[f].keypoints.length;++d)h[f].keypoints[d].name=_.COCO_KEYPOINTS[d],h[f].keypoints[d].y*=r.height,h[f].keypoints[d].x*=r.width;return[2,h]}}))}))},e.prototype.estimateSinglePose=function(e,t,n){return r(this,void 0,void 0,(function(){var r,l,i,h,f=this;return o(this,(function(o){switch(o.label){case 0:return this.cropRegion||(this.cropRegion=M.initCropRegion(null==this.cropRegion,t)),r=c.tidy((function(){var t=c.tensor2d([[f.cropRegion.yMin,f.cropRegion.xMin,f.cropRegion.yMax,f.cropRegion.xMax]]),n=c.zeros([1],"int32"),r=[f.modelInputResolution.height,f.modelInputResolution.width];return c.cast(c.image.cropAndResize(e,t,n,r,"bilinear",0),"int32")})),e.dispose(),[4,this.runSinglePersonPoseModel(r)];case 1:if(l=o.sent(),r.dispose(),l.score<this.minPoseScore)return this.reset(),[2,[]];for(i=0;i<l.keypoints.length;++i)l.keypoints[i].y=this.cropRegion.yMin+l.keypoints[i].y*this.cropRegion.height,l.keypoints[i].x=this.cropRegion.xMin+l.keypoints[i].x*this.cropRegion.width;return null!=n&&this.enableSmoothing&&(l.keypoints=this.keypointFilter.apply(l.keypoints,n,1)),h=M.determineNextCropRegion(this.cropRegion,l.keypoints,this.keypointIndexByName,t),this.cropRegion=this.filterCropRegion(h),[2,[l]]}}))}))},e.prototype.estimateMultiplePoses=function(e,t,n){return r(this,void 0,void 0,(function(){var r,l,h,f,d,_,y,m,O,i,v,S=this;return o(this,(function(o){switch(o.label){case 0:return 32,t.width>t.height?(l=this.multiPoseMaxDimension,h=Math.round(this.multiPoseMaxDimension*t.height/t.width),r=c.image.resizeBilinear(e,[h,l]),d=l,_=32*Math.ceil(h/32),f=c.pad(r,[[0,0],[0,_-h],[0,0],[0,0]])):(l=Math.round(this.multiPoseMaxDimension*t.width/t.height),h=this.multiPoseMaxDimension,r=c.image.resizeBilinear(e,[h,l]),d=32*Math.ceil(l/32),_=h,f=c.pad(r,[[0,0],[0,0],[0,d-l],[0,0]])),r.dispose(),e.dispose(),y=c.cast(f,"int32"),f.dispose(),[4,this.runMultiPersonPoseModel(y)];case 1:for(m=o.sent(),y.dispose(),m=m.filter((function(e){return e.score>=S.minPoseScore})),i=0;i<m.length;++i)for(O=0;O<m[i].keypoints.length;++O)m[i].keypoints[O].y*=_/h,m[i].keypoints[O].x*=d/l;if(this.enableTracking&&(this.tracker.apply(m,n),this.enableSmoothing)){for(i=0;i<m.length;++i)this.keypointFilterMap.has(m[i].id)||this.keypointFilterMap.set(m[i].id,new E.KeypointsOneEuroFilter(I.KEYPOINT_FILTER_CONFIG)),m[i].keypoints=this.keypointFilterMap.get(m[i].id).apply(m[i].keypoints,n,1);v=this.tracker.getTrackIDs(),this.keypointFilterMap.forEach((function(e,t){v.has(t)||S.keypointFilterMap.delete(t)}))}return[2,m]}}))}))},e.prototype.filterCropRegion=function(e){if(e){var t=this.cropRegionFilterYMin.apply(e.yMin),n=this.cropRegionFilterXMin.apply(e.xMin),r=this.cropRegionFilterYMax.apply(e.yMax),o=this.cropRegionFilterXMax.apply(e.xMax);return{yMin:t,xMin:n,yMax:r,xMax:o,height:r-t,width:o-n}}return this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset(),null},e.prototype.dispose=function(){this.moveNetModel.dispose()},e.prototype.reset=function(){this.cropRegion=null,this.resetFilters()},e.prototype.resetFilters=function(){this.keypointFilter.reset(),this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset()},e}();t.load=function(e){return void 0===e&&(e=I.MOVENET_CONFIG),r(this,void 0,void 0,(function(){var t,n,r,h;return o(this,(function(o){switch(o.label){case 0:return t=N.validateModelConfig(e),r=!0,t.modelUrl?(r="string"==typeof t.modelUrl&&t.modelUrl.indexOf("https://tfhub.dev")>-1,[4,l.loadGraphModel(t.modelUrl,{fromTFHub:r})]):[3,2];case 1:return n=o.sent(),[3,4];case 2:return h=void 0,t.modelType===I.SINGLEPOSE_LIGHTNING?h=I.MOVENET_SINGLEPOSE_LIGHTNING_URL:t.modelType===I.SINGLEPOSE_THUNDER?h=I.MOVENET_SINGLEPOSE_THUNDER_URL:t.modelType===I.MULTIPOSE_LIGHTNING&&(h=I.MOVENET_MULTIPOSE_LIGHTNING_URL),[4,l.loadGraphModel(h,{fromTFHub:r})];case 3:n=o.sent(),o.label=4;case 4:return"webgl"===c.getBackend()&&c.env().set("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",0),[2,new P(n,t)]}}))}))}},893:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,b){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},r(e,b)},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)});Object.defineProperty(t,"__esModule",{value:!0}),t.BoundingBoxTracker=void 0;var l=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.computeSimilarity=function(e){var t=this;return 0===e.length||0===this.tracks.length?[[]]:e.map((function(e){return t.tracks.map((function(track){return t.iou(e,track)}))}))},t.prototype.iou=function(e,track){var t=Math.max(e.box.xMin,track.box.xMin),n=Math.max(e.box.yMin,track.box.yMin),r=Math.min(e.box.xMax,track.box.xMax),o=Math.min(e.box.yMax,track.box.yMax);if(t>=r||n>=o)return 0;var l=(r-t)*(o-n);return l/(e.box.width*e.box.height+track.box.width*track.box.height-l)},t}(n(776).Tracker);t.BoundingBoxTracker=l},894:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateTrackerConfig=void 0,t.validateTrackerConfig=function(e){if(e.maxTracks<1)throw new Error("Must specify 'maxTracks' to be at least 1, but encountered "+e.maxTracks);if(e.maxAge<=0)throw new Error("Must specify 'maxAge' to be positive, but encountered "+e.maxAge);if(void 0!==e.keypointTrackerParams){if(e.keypointTrackerParams.keypointConfidenceThreshold<0||e.keypointTrackerParams.keypointConfidenceThreshold>1)throw new Error("Must specify 'keypointConfidenceThreshold' to be in the range [0, 1], but encountered "+e.keypointTrackerParams.keypointConfidenceThreshold);if(e.keypointTrackerParams.minNumberOfKeypoints<1)throw new Error("Must specify 'minNumberOfKeypoints' to be at least 1, but encountered "+e.keypointTrackerParams.minNumberOfKeypoints);for(var t=0,n=e.keypointTrackerParams.keypointFalloff;t<n.length;t++){var r=n[t];if(r<=0)throw new Error("Must specify each keypoint falloff parameterto be positive but encountered "+r)}}}},895:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,b){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])},r(e,b)},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)}),l=this&&this.__spreadArrays||function(){for(var s=0,i=0,e=arguments.length;i<e;i++)s+=arguments[i].length;var t=Array(s),n=0;for(i=0;i<e;i++)for(var a=arguments[i],r=0,o=a.length;r<o;r++,n++)t[n]=a[r];return t};Object.defineProperty(t,"__esModule",{value:!0}),t.KeypointTracker=void 0;var c=function(e){function t(t){var n=e.call(this,t)||this;return n.keypointThreshold=t.keypointTrackerParams.keypointConfidenceThreshold,n.keypointFalloff=t.keypointTrackerParams.keypointFalloff,n.minNumKeyoints=t.keypointTrackerParams.minNumberOfKeypoints,n}return o(t,e),t.prototype.computeSimilarity=function(e){if(0===e.length||0===this.tracks.length)return[[]];for(var t=[],n=0,r=e;n<r.length;n++){for(var o=r[n],l=[],c=0,h=this.tracks;c<h.length;c++){var track=h[c];l.push(this.oks(o,track))}t.push(l)}return t},t.prototype.oks=function(e,track){for(var t=this.area(track.keypoints)+1e-6,n=0,r=0,i=0;i<e.keypoints.length;++i){var o=e.keypoints[i],l=track.keypoints[i];if(!(o.score<this.keypointThreshold||l.score<this.keypointThreshold)){r+=1;var c=Math.pow(o.x-l.x,2)+Math.pow(o.y-l.y,2),h=2*this.keypointFalloff[i];n+=Math.exp(-1*c/(2*t*Math.pow(h,2)))}}return r<this.minNumKeyoints?0:n/r},t.prototype.area=function(e){var t=this,n=e.filter((function(e){return e.score>t.keypointThreshold})),r=Math.min.apply(Math,l([1],n.map((function(e){return e.x})))),o=Math.max.apply(Math,l([0],n.map((function(e){return e.x})))),c=Math.min.apply(Math,l([1],n.map((function(e){return e.y}))));return(o-r)*(Math.max.apply(Math,l([0],n.map((function(e){return e.y}))))-c)},t}(n(776).Tracker);t.KeypointTracker=c},896:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initCropRegion=t.determineNextCropRegion=t.torsoVisible=void 0;var r=n(573),o=n(633);function l(e,t){return(e[t.left_hip].score>o.MIN_CROP_KEYPOINT_SCORE||e[t.right_hip].score>o.MIN_CROP_KEYPOINT_SCORE)&&(e[t.left_shoulder].score>o.MIN_CROP_KEYPOINT_SCORE||e[t.right_shoulder].score>o.MIN_CROP_KEYPOINT_SCORE)}function c(e,t){var n,r,o,l;return e?t.width>t.height?(n=1,r=t.height/t.width,o=0,l=(t.width/2-t.height/2)/t.width):(n=t.width/t.height,r=1,o=(t.height/2-t.width/2)/t.height,l=0):t.width>t.height?(n=t.width/t.height,r=1,o=(t.height/2-t.width/2)/t.height,l=0):(n=1,r=t.height/t.width,o=0,l=(t.width/2-t.height/2)/t.width),{yMin:o,xMin:l,yMax:o+n,xMax:l+r,height:n,width:r}}t.torsoVisible=l,t.determineNextCropRegion=function(e,t,n,h){for(var f={},d=0,_=r.COCO_KEYPOINTS;d<_.length;d++){var y=_[d];f[y]=[t[n[y]].y*h.height,t[n[y]].x*h.width]}if(l(t,n)){var m=(f.left_hip[0]+f.right_hip[0])/2,O=(f.left_hip[1]+f.right_hip[1])/2,E=function(e,t,n,r,l){for(var c=["left_shoulder","right_shoulder","left_hip","right_hip"],h=0,f=0,i=0;i<c.length;i++)(O=Math.abs(r-n[c[i]][0]))>h&&(h=O),(E=Math.abs(l-n[c[i]][1]))>f&&(f=E);for(var d=0,_=0,y=0,m=Object.keys(n);y<m.length;y++){var O,E,v=m[y];e[t[v]].score<o.MIN_CROP_KEYPOINT_SCORE||((O=Math.abs(r-n[v][0]))>d&&(d=O),(E=Math.abs(l-n[v][1]))>_&&(_=E))}return[h,f,d,_]}(t,n,f,m,O),v=E[0],S=E[1],T=E[2],I=E[3],M=Math.max(1.9*S,1.9*v,1.2*T,1.2*I),N=[m-(M=Math.min(M,Math.max(O,h.width-O,m,h.height-m))),O-M];if(M>Math.max(h.width,h.height)/2)return c(null==e,h);var P=2*M;return{yMin:N[0]/h.height,xMin:N[1]/h.width,yMax:(N[0]+P)/h.height,xMax:(N[1]+P)/h.width,height:(N[0]+P)/h.height-N[0]/h.height,width:(N[1]+P)/h.width-N[1]/h.width}}return c(null==e,h)},t.initCropRegion=c},897:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.mergeBoundingBoxTrackerConfig=t.mergeKeypointTrackerConfig=t.validateEstimationConfig=t.validateModelConfig=void 0;var o=n(678),l=n(633);function c(e,t){var n={maxTracks:e.maxTracks,maxAge:e.maxAge,minSimilarity:e.minSimilarity};return null!=t.maxTracks&&(n.maxTracks=t.maxTracks),null!=t.maxAge&&(n.maxAge=t.maxAge),null!=t.minSimilarity&&(n.minSimilarity=t.minSimilarity),n}function h(e){var t=c(l.DEFAULT_KEYPOINT_TRACKER_CONFIG,e);return t.keypointTrackerParams=r({},l.DEFAULT_KEYPOINT_TRACKER_CONFIG.keypointTrackerParams),null!=e.keypointTrackerParams&&(null!=e.keypointTrackerParams.keypointConfidenceThreshold&&(t.keypointTrackerParams.keypointConfidenceThreshold=e.keypointTrackerParams.keypointConfidenceThreshold),null!=e.keypointTrackerParams.keypointFalloff&&(t.keypointTrackerParams.keypointFalloff=e.keypointTrackerParams.keypointFalloff),null!=e.keypointTrackerParams.minNumberOfKeypoints&&(t.keypointTrackerParams.minNumberOfKeypoints=e.keypointTrackerParams.minNumberOfKeypoints)),t}function f(e){return c(l.DEFAULT_BOUNDING_BOX_TRACKER_CONFIG,e)}t.validateModelConfig=function(e){var t=null==e?l.MOVENET_CONFIG:r({},e);if(null==t.modelType)t.modelType="SinglePose.Lightning";else if(l.VALID_MODELS.indexOf(t.modelType)<0)throw new Error("Invalid architecture "+t.modelType+". Should be one of "+l.VALID_MODELS);if(null==t.enableSmoothing&&(t.enableSmoothing=!0),null!=t.minPoseScore&&(t.minPoseScore<0||t.minPoseScore>1))throw new Error("minPoseScore should be between 0.0 and 1.0");if(null!=t.multiPoseMaxDimension&&(t.multiPoseMaxDimension%32!=0||t.multiPoseMaxDimension<32))throw new Error("multiPoseMaxDimension must be a multiple of 32 and higher than 0");if(t.modelType===l.MULTIPOSE_LIGHTNING&&null==t.enableTracking&&(t.enableTracking=!0),t.modelType===l.MULTIPOSE_LIGHTNING&&!0===t.enableTracking)if(null==t.trackerType&&(t.trackerType=o.TrackerType.BoundingBox),t.trackerType===o.TrackerType.Keypoint)null!=t.trackerConfig?t.trackerConfig=h(t.trackerConfig):t.trackerConfig=l.DEFAULT_KEYPOINT_TRACKER_CONFIG;else{if(t.trackerType!==o.TrackerType.BoundingBox)throw new Error("Tracker type not supported by MoveNet");null!=t.trackerConfig?t.trackerConfig=f(t.trackerConfig):t.trackerConfig=l.DEFAULT_BOUNDING_BOX_TRACKER_CONFIG}return t},t.validateEstimationConfig=function(e){return null==e?l.MOVENET_ESTIMATION_CONFIG:r({},e)},t.mergeKeypointTrackerConfig=h,t.mergeBoundingBoxTrackerConfig=f},898:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{f(r.next(e))}catch(e){l(e)}}function h(e){try{f(r.throw(e))}catch(e){l(e)}}function f(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,h)}f((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.load=void 0;var l=n(637),c=n(545),h=n(769),f=n(581),d=n(770),_=n(899),y=n(903),m=n(905),O=n(906),E=n(634),v=n(907),S=n(908),T=function(){function e(e,t){this.posenetModel=e;var n=this.posenetModel.inputs[0].shape;c.util.assert(-1===n[1]&&-1===n[2],(function(){return"Input shape ["+n[1]+", "+n[2]+"] must both be equal to or -1"}));var r=S.getValidInputResolutionDimensions(t.inputResolution,t.outputStride);v.assertValidOutputStride(t.outputStride),v.assertValidResolution(r,t.outputStride),this.inputResolution=r,this.outputStride=t.outputStride,this.architecture=t.architecture}return e.prototype.estimatePoses=function(image,e){return void 0===e&&(e=E.SINGLE_PERSON_ESTIMATION_CONFIG),r(this,void 0,void 0,(function(){var t,n,r,l,S,T,I,M,N,P,L,w,x,A,k;return o(this,(function(o){switch(o.label){case 0:return t=v.validateEstimationConfig(e),null==image?[2,[]]:(this.maxPoses=t.maxPoses,n=h.convertImageToTensor(image,{outputTensorSize:this.inputResolution,keepAspectRatio:!0,borderMode:"replicate"}),r=n.imageTensor,l=n.padding,S="ResNet50"===this.architecture?c.add(r,E.RESNET_MEAN):d.shiftImageValue(r,[-1,1]),T=this.posenetModel.predict(S),"ResNet50"===this.architecture?(I=c.squeeze(T[2],[0]),M=c.squeeze(T[3],[0]),N=c.squeeze(T[0],[0]),P=c.squeeze(T[1],[0])):(I=c.squeeze(T[0],[0]),M=c.squeeze(T[1],[0]),N=c.squeeze(T[2],[0]),P=c.squeeze(T[3],[0])),L=c.sigmoid(M),1!==this.maxPoses?[3,2]:[4,y.decodeSinglePose(L,I,this.outputStride)]);case 1:return x=o.sent(),w=[x],[3,4];case 2:return[4,_.decodeMultiplePoses(L,I,N,P,this.outputStride,this.maxPoses,t.scoreThreshold,t.nmsRadius)];case 3:w=o.sent(),o.label=4;case 4:return A=f.getImageSize(image),k=O.scalePoses(w,A,this.inputResolution,l),t.flipHorizontal&&(k=m.flipPosesHorizontal(k,A)),r.dispose(),S.dispose(),c.dispose(T),I.dispose(),M.dispose(),N.dispose(),P.dispose(),L.dispose(),[2,k]}}))}))},e.prototype.dispose=function(){this.posenetModel.dispose()},e.prototype.reset=function(){},e}();t.load=function(e){return void 0===e&&(e=E.MOBILENET_V1_CONFIG),r(this,void 0,void 0,(function(){var t,n,r,c,h;return o(this,(function(o){switch(o.label){case 0:return"ResNet50"!==(t=v.validateModelConfig(e)).architecture?[3,2]:(n=S.resNet50Checkpoint(t.outputStride,t.quantBytes),[4,l.loadGraphModel(t.modelUrl||n)]);case 1:return r=o.sent(),[2,new T(r,t)];case 2:return c=S.mobileNetCheckpoint(t.outputStride,t.multiplier,t.quantBytes),[4,l.loadGraphModel(t.modelUrl||c)];case 3:return h=o.sent(),[2,new T(h,t)]}}))}))}},899:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{f(r.next(e))}catch(e){l(e)}}function h(e){try{f(r.throw(e))}catch(e){l(e)}}function f(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,h)}f((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.decodeMultiplePoses=void 0;var l=n(634),c=n(900),h=n(902);t.decodeMultiplePoses=function(e,t,n,f,d,_,y,m){return void 0===y&&(y=.5),void 0===m&&(m=20),r(this,void 0,void 0,(function(){var r,O,E,v,S,T,I,M,N,P,L,w;return o(this,(function(o){switch(o.label){case 0:return[4,h.toTensorBuffers3D([e,t,n,f])];case 1:for(r=o.sent(),O=r[0],E=r[1],v=r[2],S=r[3],T=[],I=c.buildPartWithScoreQueue(y,l.K_LOCAL_MAXIMUM_RADIUS,O),M=m*m;T.length<_&&!I.empty();)N=I.dequeue(),P=h.getImageCoords(N.part,d,E),h.withinNmsRadiusOfCorrespondingPoint(T,M,P,N.part.id)||(L=h.decodePose(N,O,E,d,v,S),w=h.getInstanceScore(T,M,L),T.push({keypoints:L,score:w}));return[2,T]}}))}))}},900:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildPartWithScoreQueue=void 0;var r=n(901);function o(e,t,n,r,o,l){for(var c=l.shape,h=c[0],f=c[1],d=!0,_=Math.max(n-o,0),y=Math.min(n+o+1,h),m=_;m<y;++m){for(var O=Math.max(r-o,0),E=Math.min(r+o+1,f),v=O;v<E;++v)if(l.get(m,v,e)>t){d=!1;break}if(!d)break}return d}t.buildPartWithScoreQueue=function(e,t,n){for(var l=n.shape,c=l[0],h=l[1],f=l[2],d=new r.MaxHeap(c*h*f,(function(e){return e.score})),_=0;_<c;++_)for(var y=0;y<h;++y)for(var m=0;m<f;++m){var O=n.get(_,y,m);O<e||o(m,O,_,y,t,n)&&d.enqueue({score:O,part:{heatmapY:_,heatmapX:y,id:m}})}return d}},901:function(e,t,n){"use strict";function r(e){return Math.floor(e/2)}Object.defineProperty(t,"__esModule",{value:!0}),t.MaxHeap=void 0;var o=function(){function e(e,t){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=t}return e.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},e.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},e.prototype.empty=function(){return-1===this.numberOfElements},e.prototype.size=function(){return this.numberOfElements+1},e.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},e.prototype.max=function(){return this.priorityQueue[0]},e.prototype.swim=function(e){for(;e>0&&this.less(r(e),e);)this.exchange(e,r(e)),e=r(e)},e.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var t=2*e;if(t<this.numberOfElements&&this.less(t,t+1)&&t++,!this.less(e,t))break;this.exchange(e,t),e=t}},e.prototype.getValueAt=function(i){return this.getElementValue(this.priorityQueue[i])},e.prototype.less=function(i,e){return this.getValueAt(i)<this.getValueAt(e)},e.prototype.exchange=function(i,e){var t=this.priorityQueue[i];this.priorityQueue[i]=this.priorityQueue[e],this.priorityQueue[e]=t},e}();t.MaxHeap=o},902:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{f(r.next(e))}catch(e){l(e)}}function h(e){try{f(r.throw(e))}catch(e){l(e)}}function f(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,h)}f((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getInstanceScore=t.decodePose=t.addVectors=t.withinNmsRadiusOfCorrespondingPoint=t.squaredDistance=t.getImageCoords=t.getOffsetPoint=t.toTensorBuffers3D=void 0;var l=n(573),c=n(634);function h(e,t,n,r){return{y:r.get(e,t,n),x:r.get(e,t,n+c.NUM_KEYPOINTS)}}function f(e,t,n){var r=h(e.heatmapY,e.heatmapX,e.id,n),o=r.y,l=r.x;return{x:e.heatmapX*t+l,y:e.heatmapY*t+o}}function d(e,t,n,r){var o=n-e,l=r-t;return o*o+l*l}function _(e,t,n,r){var o=n.x,l=n.y;return e.some((function(e){var n=e.keypoints;return d(l,o,n[r].y,n[r].x)<=t}))}t.toTensorBuffers3D=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){return[2,Promise.all(e.map((function(e){return e.buffer()})))]}))}))},t.getOffsetPoint=h,t.getImageCoords=f,t.squaredDistance=d,t.withinNmsRadiusOfCorrespondingPoint=_;var y=l.COCO_KEYPOINTS.reduce((function(e,t,i){return e[t]=i,e}),{}),m=c.POSE_CHAIN.map((function(e){var t=e[0],n=e[1];return[y[t],y[n]]})),O=m.map((function(e){return e[1]})),E=m.map((function(e){return e[0]}));function v(a,e,t){return a<e?e:a>t?t:a}function S(e,t,n,r){return{y:v(Math.round(e.y/t),0,n-1),x:v(Math.round(e.x/t),0,r-1)}}function T(a,b){return{x:a.x+b.x,y:a.y+b.y}}function I(e,t,n,r,o,c,f,d){void 0===d&&(d=2);for(var _=r.shape,y=_[0],m=_[1],O={y:t.y,x:t.x},E=function(e,t,n){var r=n.shape[2]/2;return{y:n.get(t.y,t.x,e),x:n.get(t.y,t.x,r+e)}}(e,S(O,c,y,m),f),v=T(O,E),i=0;i<d;i++){var I=S(v,c,y,m),M=h(I.y,I.x,n,o);v=T({x:I.x*c,y:I.y*c},{x:M.x,y:M.y})}var N=S(v,c,y,m),P=r.get(N.y,N.x,n);return{y:v.y,x:v.x,name:l.COCO_KEYPOINTS[n],score:P}}t.addVectors=T,t.decodePose=function(e,t,n,r,o,c){var h=t.shape[2],d=O.length,_=new Array(h),y=e.part,m=e.score,v=f(y,r,n);_[y.id]={score:m,name:l.COCO_KEYPOINTS[y.id],y:v.y,x:v.x};for(var S=d-1;S>=0;--S){var T=O[S],M=E[S];_[T]&&!_[M]&&(_[M]=I(S,_[T],M,t,n,r,c))}for(S=0;S<d;++S){T=E[S],M=O[S];_[T]&&!_[M]&&(_[M]=I(S,_[T],M,t,n,r,o))}return _},t.getInstanceScore=function(e,t,n){return n.reduce((function(n,r,o){var l=r.y,c=r.x,h=r.score;return _(e,t,{y:l,x:c},o)||(n+=h),n}),0)/n.length}},903:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{f(r.next(e))}catch(e){l(e)}}function h(e){try{f(r.throw(e))}catch(e){l(e)}}function f(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,h)}f((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.decodeSinglePose=void 0;var l=n(573),c=n(904);t.decodeSinglePose=function(e,t,n){return r(this,void 0,void 0,(function(){var r,h,f,d,_,y,m,O,E,v;return o(this,(function(o){switch(o.label){case 0:return r=0,h=c.argmax2d(e),[4,Promise.all([e.buffer(),t.buffer(),h.buffer()])];case 1:return f=o.sent(),d=f[0],_=f[1],y=f[2],[4,(m=c.getOffsetPoints(y,n,_)).buffer()];case 2:return O=o.sent(),E=Array.from(c.getPointsConfidence(d,y)),v=E.map((function(e,t){return r+=e,{y:O.get(t,0),x:O.get(t,1),score:e,name:l.COCO_KEYPOINTS[t]}})),h.dispose(),m.dispose(),[2,{keypoints:v,score:r/v.length}]}}))}))}},904:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOffsetVectors=t.getOffsetPoints=t.getPointsConfidence=t.argmax2d=void 0;var r=n(545),o=n(573);function l(e,t){for(var n=[],l=0;l<o.COCO_KEYPOINTS.length;l++){var h=c(e.get(l,0).valueOf(),e.get(l,1).valueOf(),l,t),f=h.x,d=h.y;n.push(d),n.push(f)}return r.tensor2d(n,[o.COCO_KEYPOINTS.length,2])}function c(e,t,n,r){return{y:r.get(e,t,n),x:r.get(e,t,n+o.COCO_KEYPOINTS.length)}}t.argmax2d=function(e){var t=e.shape,n=t[0],o=t[1],l=t[2];return r.tidy((function(){var a,b,t=r.reshape(e,[n*o,l]),c=r.argMax(t,0),h=r.expandDims(r.div(c,r.scalar(o,"int32")),1),f=r.expandDims((a=c,b=o,r.tidy((function(){var e=r.div(a,r.scalar(b,"int32"));return r.sub(a,r.mul(e,r.scalar(b,"int32")))}))),1);return r.concat([h,f],1)}))},t.getPointsConfidence=function(e,t){for(var n=t.shape[0],r=new Float32Array(n),o=0;o<n;o++){var l=t.get(o,0),c=t.get(o,1);r[o]=e.get(l,c,o)}return r},t.getOffsetPoints=function(e,t,n){return r.tidy((function(){var o=l(e,n);return r.add(r.cast(r.mul(e.toTensor(),r.scalar(t,"int32")),"float32"),o)}))},t.getOffsetVectors=l},905:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flipPosesHorizontal=void 0,t.flipPosesHorizontal=function(e,t){for(var n=0,r=e;n<r.length;n++)for(var o=0,l=r[n].keypoints;o<l.length;o++){var c=l[o];c.x=t.width-1-c.x}return e}},906:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scalePoses=void 0,t.scalePoses=function(e,t,n,r){var o=t.height,l=t.width,c=o/(n.height*(1-r.top-r.bottom)),h=l/(n.width*(1-r.left-r.right)),f=-r.top*n.height,d=-r.left*n.width;if(1===h&&1===c&&0===f&&0===d)return e;for(var _=0,y=e;_<y.length;_++)for(var m=0,O=y[_].keypoints;m<O.length;m++){var E=O[m];E.x=(E.x+d)*h,E.y=(E.y+f)*c}return e}},907:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.validateEstimationConfig=t.assertValidResolution=t.assertValidOutputStride=t.validateModelConfig=void 0;var o=n(545),l=n(634);function c(e,t){return(e-1)%t==0}t.validateModelConfig=function(e){var t=e||l.MOBILENET_V1_CONFIG;if(null==t.architecture&&(t.architecture="MobileNetV1"),l.VALID_ARCHITECTURE.indexOf(t.architecture)<0)throw new Error("Invalid architecture "+t.architecture+". Should be one of "+l.VALID_ARCHITECTURE);if(null==t.inputResolution&&(t.inputResolution={height:257,width:257}),null==t.outputStride&&(t.outputStride=16),l.VALID_STRIDE[t.architecture].indexOf(t.outputStride)<0)throw new Error("Invalid outputStride "+t.outputStride+". Should be one of "+l.VALID_STRIDE[t.architecture]+" for architecture "+t.architecture+".");if(null==t.multiplier&&(t.multiplier=1),l.VALID_MULTIPLIER[t.architecture].indexOf(t.multiplier)<0)throw new Error("Invalid multiplier "+t.multiplier+". Should be one of "+l.VALID_MULTIPLIER[t.architecture]+" for architecture "+t.architecture+".");if(null==t.quantBytes&&(t.quantBytes=4),l.VALID_QUANT_BYTES.indexOf(t.quantBytes)<0)throw new Error("Invalid quantBytes "+t.quantBytes+". Should be one of "+l.VALID_QUANT_BYTES+" for architecture "+t.architecture+".");if("MobileNetV1"===t.architecture&&32===t.outputStride&&1!==t.multiplier)throw new Error("When using an output stride of 32, you must select 1 as the multiplier.");return t},t.assertValidOutputStride=function(e){o.util.assert(l.VALID_OUTPUT_STRIDES.indexOf(e)>=0,(function(){return"outputStride of "+e+" is invalid. It must be either 8 or 16."}))},t.assertValidResolution=function(e,t){o.util.assert(c(e.height,t),(function(){return"height of "+e.height+" is invalid for output stride "+t+"."})),o.util.assert(c(e.width,t),(function(){return"width of "+e.width+" is invalid for output stride "+t+"."}))},t.validateEstimationConfig=function(e){var t=e;if(null==t.maxPoses&&(t.maxPoses=1),t.maxPoses<=0)throw new Error("Invalid maxPoses "+t.maxPoses+". Should be > 0.");if(t.maxPoses>1){if((t=r(r({},l.MULTI_PERSON_ESTIMATION_CONFIG),t)).scoreThreshold<0||t.scoreThreshold>1)throw new Error("Invalid scoreThreshold "+t.scoreThreshold+". Should be in range [0.0, 1.0]");if(t.nmsRadius<=0)throw new Error("Invalid nmsRadius "+t.nmsRadius+".")}return t}},908:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toValidInputResolution=t.getValidInputResolutionDimensions=t.mobileNetCheckpoint=t.resNet50Checkpoint=void 0;var r="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/mobilenet/",o="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/resnet50/";function l(e,t){return function(e,t){return(e-1)%t==0}(e,t)?e:Math.floor(e/t)*t+1}t.resNet50Checkpoint=function(e,t){var n="model-stride"+e+".json";return 4===t?o+"float/"+n:o+"quant"+t+"/"+n},t.mobileNetCheckpoint=function(e,t,n){var o={1:"100",.75:"075",.5:"050"},l="model-stride"+e+".json";return 4===n?r+"float/"+o[t]+"/"+l:r+"quant"+n+"/"+o[t]+"/"+l},t.getValidInputResolutionDimensions=function(e,t){return{height:l(e.height,t),width:l(e.width,t)}},t.toValidInputResolution=l}}]);